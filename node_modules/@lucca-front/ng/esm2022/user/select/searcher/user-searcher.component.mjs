import { CommonModule } from '@angular/common';
import { ChangeDetectionStrategy, Component, ElementRef, forwardRef, HostBinding, Inject, Input, Optional, Output, Self, SkipSelf, ViewChild } from '@angular/core';
import { FormControl, FormGroup, ReactiveFormsModule } from '@angular/forms';
import { ALuOnCloseSubscriber, ALuOnOpenSubscriber, ALuOnScrollBottomSubscriber, getIntl } from '@lucca-front/ng/core';
import { ALuOptionOperator, LuOptionPlaceholderComponent } from '@lucca-front/ng/option';
import { BehaviorSubject, combineLatest, merge, of, Subject, Subscription } from 'rxjs';
import { catchError, debounceTime, filter, map, scan, share, startWith, switchMap } from 'rxjs/operators';
import { ALuUserService, LuUserV3Service } from '../../service/index';
import { LU_USER_SEARCHER_TRANSLATIONS } from './user-searcher.translate';
import * as i0 from "@angular/core";
import * as i1 from "@angular/forms";
import * as i2 from "@angular/common";
import * as i3 from "../../service/index";
class LuUserPagedSearcherComponent {
    set fields(fields) {
        this._service.fields = fields;
    }
    set filters(filters) {
        this._service.filters = filters;
    }
    set orderBy(orderBy) {
        this._service.orderBy = orderBy;
    }
    set appInstanceId(appInstanceId) {
        this._service.appInstanceId = appInstanceId;
    }
    set operations(operations) {
        this._service.operations = operations;
    }
    constructor(hostService, selfService) {
        this._subs = new Subscription();
        this.fixed = true;
        this.enableFormerEmployees = false;
        // page$: Subject<number>;
        this.outOptions$ = new Subject();
        this._loading = false;
        this._isOpened$ = new BehaviorSubject(false);
        this._page$ = new Subject();
        this._options = [];
        this.intl = getIntl(LU_USER_SEARCHER_TRANSLATIONS);
        this._service = hostService || selfService;
        const clue = new FormControl('');
        this.form = new FormGroup({
            clue,
            formerEmployees: new FormControl(false),
        });
        this.clueChange = clue.valueChanges;
    }
    ngOnInit() {
        const formValue$ = this.form.valueChanges.pipe(startWith(this.form.value));
        const pager$ = this._page$.pipe(scan((acc) => acc + 1, 0), startWith(0));
        const query$ = combineLatest([formValue$.pipe(debounceTime(250)), this._isOpened$]).pipe(filter(([, isOpened]) => isOpened), switchMap(([val]) => pager$.pipe(map((page) => [val, page]))), share());
        const results$ = query$.pipe(switchMap(([val, page]) => {
            const filters = [];
            if (val.formerEmployees) {
                filters.push(`formerEmployees=true`);
            }
            return this._service.searchPaged(val.clue, page, filters).pipe(catchError(() => of([])), map((items) => [items, page]));
        }), share());
        const resultsSub = results$.subscribe(([items, page]) => {
            if (page === 0) {
                this._options = [...items];
            }
            else {
                this._options.push(...items);
            }
            this._isLastPage = !items.length;
            this.outOptions$.next([...this._options]);
        });
        this._subs.add(resultsSub);
        this.loading$ = merge(query$.pipe(map(() => true)), results$.pipe(map(() => false)));
        const loadingSub = this.loading$.subscribe((l) => (this._loading = l));
        this._subs.add(loadingSub);
        this.empty$ = this.outOptions$.pipe(map((o) => o.length === 0));
    }
    ngOnDestroy() {
        this._subs.unsubscribe();
    }
    onOpen() {
        this.searchInput.nativeElement.focus();
        this._isOpened$.next(true);
    }
    onScrollBottom() {
        if (!this._loading && !this._isLastPage) {
            this._page$.next();
        }
    }
    onClose() {
        this._isOpened$.next(false);
        this.outOptions$.next([]);
        this.reset();
    }
    reset() {
        if (this.form.dirty) {
            this.form.reset();
        }
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.3", ngImport: i0, type: LuUserPagedSearcherComponent, deps: [{ token: ALuUserService, optional: true, skipSelf: true }, { token: ALuUserService, self: true }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.3", type: LuUserPagedSearcherComponent, isStandalone: true, selector: "lu-user-paged-searcher", inputs: { fields: "fields", filters: "filters", orderBy: "orderBy", appInstanceId: "appInstanceId", operations: "operations", enableFormerEmployees: "enableFormerEmployees" }, outputs: { clueChange: "clueChange" }, host: { properties: { "class.position-fixed": "this.fixed" } }, providers: [
            {
                provide: ALuOptionOperator,
                useExisting: forwardRef(() => LuUserPagedSearcherComponent),
                multi: true,
            },
            {
                provide: ALuOnOpenSubscriber,
                useExisting: forwardRef(() => LuUserPagedSearcherComponent),
                multi: true,
            },
            {
                provide: ALuOnCloseSubscriber,
                useExisting: forwardRef(() => LuUserPagedSearcherComponent),
                multi: true,
            },
            {
                provide: ALuOnScrollBottomSubscriber,
                useExisting: forwardRef(() => LuUserPagedSearcherComponent),
                multi: true,
            },
            {
                provide: ALuUserService,
                useClass: LuUserV3Service,
            },
        ], viewQueries: [{ propertyName: "searchInput", first: true, predicate: ["searchInput"], descendants: true, read: ElementRef, static: true }], ngImport: i0, template: "<form [formGroup]=\"form\">\n\t<div class=\"textfield mod-search\" [class.is-loading]=\"loading$ | async\">\n\t\t<input #searchInput class=\"textfield-input\" formControlName=\"clue\" />\n\t</div>\n\n\t<label class=\"checkbox mod-formerEmployee mod-S\" *ngIf=\"enableFormerEmployees\">\n\t\t<input class=\"checkbox-input\" type=\"checkbox\" formControlName=\"formerEmployees\" />\n\t\t<span class=\"checkbox-label\">{{ intl.includeFormerEmployees }}</span>\n\t</label>\n</form>\n\n<lu-option-placeholder *ngIf=\"(empty$ | async) && (loading$ | async) === false\" (onClear)=\"reset()\"></lu-option-placeholder>\n", styles: [":root{--components-options-item-padding-vertical: var(--spacings-XS);--components-options-item-padding-horizontal: var(--spacings-XS);--components-options-item-multiple-padding: 2.25rem;--components-options-item-icon-color: var(--palettes-grey-800);--components-options-checkbox-left: .5rem;--components-options-checkbox-size: 1.25rem;--components-options-checkbox-color: var(--palettes-primary-700);--components-options-checkbox-border-radius: 6px;--components-options-checkbox-border-color: var(--palettes-grey-700);--components-options-establishment-multiple-padding: 2rem}.textfield.mod-search{width:100%}.textfield-input{outline:none}.checkbox.mod-formerEmployee{padding:var(--spacings-XXS) var(--components-options-item-padding-horizontal);border-bottom:var(--commons-divider-width) solid var(--commons-divider-color);background-color:var(--palettes-grey-50);font-style:italic}\n"], dependencies: [{ kind: "ngmodule", type: ReactiveFormsModule }, { kind: "directive", type: i1.ɵNgNoValidate, selector: "form:not([ngNoForm]):not([ngNativeValidate])" }, { kind: "directive", type: i1.DefaultValueAccessor, selector: "input:not([type=checkbox])[formControlName],textarea[formControlName],input:not([type=checkbox])[formControl],textarea[formControl],input:not([type=checkbox])[ngModel],textarea[ngModel],[ngDefaultControl]" }, { kind: "directive", type: i1.CheckboxControlValueAccessor, selector: "input[type=checkbox][formControlName],input[type=checkbox][formControl],input[type=checkbox][ngModel]" }, { kind: "directive", type: i1.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { kind: "directive", type: i1.NgControlStatusGroup, selector: "[formGroupName],[formArrayName],[ngModelGroup],[formGroup],form:not([ngNoForm]),[ngForm]" }, { kind: "directive", type: i1.FormGroupDirective, selector: "[formGroup]", inputs: ["formGroup"], outputs: ["ngSubmit"], exportAs: ["ngForm"] }, { kind: "directive", type: i1.FormControlName, selector: "[formControlName]", inputs: ["formControlName", "disabled", "ngModel"], outputs: ["ngModelChange"] }, { kind: "ngmodule", type: CommonModule }, { kind: "directive", type: i2.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "pipe", type: i2.AsyncPipe, name: "async" }, { kind: "component", type: LuOptionPlaceholderComponent, selector: "lu-option-placeholder", outputs: ["onClear"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
export { LuUserPagedSearcherComponent };
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.3", ngImport: i0, type: LuUserPagedSearcherComponent, decorators: [{
            type: Component,
            args: [{ selector: 'lu-user-paged-searcher', changeDetection: ChangeDetectionStrategy.OnPush, standalone: true, imports: [ReactiveFormsModule, CommonModule, LuOptionPlaceholderComponent], providers: [
                        {
                            provide: ALuOptionOperator,
                            useExisting: forwardRef(() => LuUserPagedSearcherComponent),
                            multi: true,
                        },
                        {
                            provide: ALuOnOpenSubscriber,
                            useExisting: forwardRef(() => LuUserPagedSearcherComponent),
                            multi: true,
                        },
                        {
                            provide: ALuOnCloseSubscriber,
                            useExisting: forwardRef(() => LuUserPagedSearcherComponent),
                            multi: true,
                        },
                        {
                            provide: ALuOnScrollBottomSubscriber,
                            useExisting: forwardRef(() => LuUserPagedSearcherComponent),
                            multi: true,
                        },
                        {
                            provide: ALuUserService,
                            useClass: LuUserV3Service,
                        },
                    ], template: "<form [formGroup]=\"form\">\n\t<div class=\"textfield mod-search\" [class.is-loading]=\"loading$ | async\">\n\t\t<input #searchInput class=\"textfield-input\" formControlName=\"clue\" />\n\t</div>\n\n\t<label class=\"checkbox mod-formerEmployee mod-S\" *ngIf=\"enableFormerEmployees\">\n\t\t<input class=\"checkbox-input\" type=\"checkbox\" formControlName=\"formerEmployees\" />\n\t\t<span class=\"checkbox-label\">{{ intl.includeFormerEmployees }}</span>\n\t</label>\n</form>\n\n<lu-option-placeholder *ngIf=\"(empty$ | async) && (loading$ | async) === false\" (onClear)=\"reset()\"></lu-option-placeholder>\n", styles: [":root{--components-options-item-padding-vertical: var(--spacings-XS);--components-options-item-padding-horizontal: var(--spacings-XS);--components-options-item-multiple-padding: 2.25rem;--components-options-item-icon-color: var(--palettes-grey-800);--components-options-checkbox-left: .5rem;--components-options-checkbox-size: 1.25rem;--components-options-checkbox-color: var(--palettes-primary-700);--components-options-checkbox-border-radius: 6px;--components-options-checkbox-border-color: var(--palettes-grey-700);--components-options-establishment-multiple-padding: 2rem}.textfield.mod-search{width:100%}.textfield-input{outline:none}.checkbox.mod-formerEmployee{padding:var(--spacings-XXS) var(--components-options-item-padding-horizontal);border-bottom:var(--commons-divider-width) solid var(--commons-divider-color);background-color:var(--palettes-grey-50);font-style:italic}\n"] }]
        }], ctorParameters: function () { return [{ type: i3.LuUserV3Service, decorators: [{
                    type: Inject,
                    args: [ALuUserService]
                }, {
                    type: Optional
                }, {
                    type: SkipSelf
                }] }, { type: i3.LuUserV3Service, decorators: [{
                    type: Inject,
                    args: [ALuUserService]
                }, {
                    type: Self
                }] }]; }, propDecorators: { fixed: [{
                type: HostBinding,
                args: ['class.position-fixed']
            }], searchInput: [{
                type: ViewChild,
                args: ['searchInput', { read: ElementRef, static: true }]
            }], fields: [{
                type: Input
            }], filters: [{
                type: Input
            }], orderBy: [{
                type: Input
            }], appInstanceId: [{
                type: Input
            }], operations: [{
                type: Input
            }], enableFormerEmployees: [{
                type: Input
            }], clueChange: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXNlci1zZWFyY2hlci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wYWNrYWdlcy9uZy91c2VyL3NlbGVjdC9zZWFyY2hlci91c2VyLXNlYXJjaGVyLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL25nL3VzZXIvc2VsZWN0L3NlYXJjaGVyL3VzZXItc2VhcmNoZXIuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQy9DLE9BQU8sRUFBRSx1QkFBdUIsRUFBRSxTQUFTLEVBQUUsVUFBVSxFQUFFLFVBQVUsRUFBRSxXQUFXLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBcUIsUUFBUSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLFNBQVMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUN2TCxPQUFPLEVBQUUsV0FBVyxFQUFFLFNBQVMsRUFBRSxtQkFBbUIsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQzdFLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxtQkFBbUIsRUFBRSwyQkFBMkIsRUFBRSxPQUFPLEVBQTBFLE1BQU0sc0JBQXNCLENBQUM7QUFDL0wsT0FBTyxFQUFFLGlCQUFpQixFQUFFLDRCQUE0QixFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDekYsT0FBTyxFQUFFLGVBQWUsRUFBRSxhQUFhLEVBQUUsS0FBSyxFQUFjLEVBQUUsRUFBRSxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ3BHLE9BQU8sRUFBRSxVQUFVLEVBQUUsWUFBWSxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDMUcsT0FBTyxFQUFFLGNBQWMsRUFBRSxlQUFlLEVBQUUs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LFdBQVcsRUFBRSxVQUFVLENBQUMsR0FBRyxFQUFFLDZCQUE2QixDQUFDOzRCQUMzRCxLQUFLLEVBQUUsSUFBSTt5QkFDWDt3QkFDRDs0QkFDQyxPQUFPLEVBQUUsbUJBQW1COzRCQUM1QixXQUFXLEVBQUUsVUFBVSxDQUFDLEdBQUcsRUFBRSw2QkFBNkIsQ0FBQzs0QkFDM0QsS0FBSyxFQUFFLElBQUk7eUJBQ1g7d0JBQ0Q7NEJBQ0MsT0FBTyxFQUFFLG9CQUFvQjs0QkFDN0IsV0FBVyxFQUFFLFVBQVUsQ0FBQyxHQUFHLEVBQUUsNkJBQTZCLENBQUM7NEJBQzNELEtBQUssRUFBRSxJQUFJO3lCQUNYO3dCQUNEOzRCQUNDLE9BQU8sRUFBRSwyQkFBMkI7NEJBQ3BDLFdBQVcsRUFBRSxVQUFVLENBQUMsR0FBRyxFQUFFLDZCQUE2QixDQUFDOzRCQUMzRCxLQUFLLEVBQUUsSUFBSTt5QkFDWDt3QkFDRDs0QkFDQyxPQUFPLEVBQUUsY0FBYzs0QkFDdkIsUUFBUSxFQUFFLGVBQWU7eUJBQ3pCO3FCQUNEOzswQkEwQ1ksTUFBTTsyQkFBQyxjQUFjOzswQkFBRyxRQUFROzswQkFBSSxRQUFROzswQkFBcUMsTUFBTTsyQkFBQyxjQUFjOzswQkFBRyxJQUFJOzRDQXBDckYsS0FBSztzQkFBekMsV0FBVzt1QkFBQyxzQkFBc0I7Z0JBRW5DLFdBQVc7c0JBRFYsU0FBUzt1QkFBQyxhQUFhLEVBQUUsRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7Z0JBRy9DLE1BQU07c0JBQWxCLEtBQUs7Z0JBR08sT0FBTztzQkFBbkIsS0FBSztnQkFHTyxPQUFPO3NCQUFuQixLQUFLO2dCQUdPLGFBQWE7c0JBQXpCLEtBQUs7Z0JBR08sVUFBVTtzQkFBdEIsS0FBSztnQkFHRyxxQkFBcUI7c0JBQTdCLEtBQUs7Z0JBRUksVUFBVTtzQkFBbkIsTUFBTSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbW1vbk1vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQgeyBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSwgQ29tcG9uZW50LCBFbGVtZW50UmVmLCBmb3J3YXJkUmVmLCBIb3N0QmluZGluZywgSW5qZWN0LCBJbnB1dCwgT25EZXN0cm95LCBPbkluaXQsIE9wdGlvbmFsLCBPdXRwdXQsIFNlbGYsIFNraXBTZWxmLCBWaWV3Q2hpbGQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEZvcm1Db250cm9sLCBGb3JtR3JvdXAsIFJlYWN0aXZlRm9ybXNNb2R1bGUgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQgeyBBTHVPbkNsb3NlU3Vic2NyaWJlciwgQUx1T25PcGVuU3Vic2NyaWJlciwgQUx1T25TY3JvbGxCb3R0b21TdWJzY3JpYmVyLCBnZXRJbnRsLCBJTHVPbkNsb3NlU3Vic2NyaWJlciwgSUx1T25PcGVuU3Vic2NyaWJlciwgSUx1T25TY3JvbGxCb3R0b21TdWJzY3JpYmVyIH0gZnJvbSAnQGx1Y2NhLWZyb250L25nL2NvcmUnO1xuaW1wb3J0IHsgQUx1T3B0aW9uT3BlcmF0b3IsIEx1T3B0aW9uUGxhY2Vob2xkZXJDb21wb25lbnQgfSBmcm9tICdAbHVjY2EtZnJvbnQvbmcvb3B0aW9uJztcbmltcG9ydCB7IEJlaGF2aW9yU3ViamVjdCwgY29tYmluZUxhdGVzdCwgbWVyZ2UsIE9ic2VydmFibGUsIG9mLCBTdWJqZWN0LCBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IGNhdGNoRXJyb3IsIGRlYm91bmNlVGltZSwgZmlsdGVyLCBtYXAsIHNjYW4sIHNoYXJlLCBzdGFydFdpdGgsIHN3aXRjaE1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IEFMdVVzZXJTZXJ2aWNlLCBMdVVzZXJWM1NlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlL2luZGV4JztcbmltcG9ydCB7IElMdVVzZXIgfSBmcm9tICcuLi8uLi91c2VyLm1vZGVsJztcbmltcG9ydCB7IExVX1VTRVJfU0VBUkNIRVJfVFJBTlNMQVRJT05TIH0gZnJvbSAnLi91c2VyLXNlYXJjaGVyLnRyYW5zbGF0ZSc7XG5cbmludGVyZmFjZSBVc2VyUGFnZWRTZWFyY2hlckZvcm0ge1xuXHRjbHVlOiBzdHJpbmc7XG5cdGZvcm1lckVtcGxveWVlczogYm9vbGVhbjtcbn1cblxuQENvbXBvbmVudCh7XG5cdHNlbGVjdG9yOiAnbHUtdXNlci1wYWdlZC1zZWFyY2hlcicsXG5cdHRlbXBsYXRlVXJsOiAndXNlci1zZWFyY2hlci5jb21wb25lbnQuaHRtbCcsXG5cdHN0eWxlVXJsczogWyd1c2VyLXNlYXJjaGVyLmNvbXBvbmVudC5zY3NzJ10sXG5cdGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxuXHRzdGFuZGFsb25lOiB0cnVlLFxuXHRpbXBvcnRzOiBbUmVhY3RpdmVGb3Jtc01vZHVsZSwgQ29tbW9uTW9kdWxlLCBMdU9wdGlvblBsYWNlaG9sZGVyQ29tcG9uZW50XSxcblx0cHJvdmlkZXJzOiBbXG5cdFx0e1xuXHRcdFx0cHJvdmlkZTogQUx1T3B0aW9uT3BlcmF0b3IsXG5cdFx0XHR1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBMdVVzZXJQYWdlZFNlYXJjaGVyQ29tcG9uZW50KSxcblx0XHRcdG11bHRpOiB0cnVlLFxuXHRcdH0sXG5cdFx0e1xuXHRcdFx0cHJvdmlkZTogQUx1T25PcGVuU3Vic2NyaWJlcixcblx0XHRcdHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgpID0+IEx1VXNlclBhZ2VkU2VhcmNoZXJDb21wb25lbnQpLFxuXHRcdFx0bXVsdGk6IHRydWUsXG5cdFx0fSxcblx0XHR7XG5cdFx0XHRwcm92aWRlOiBBTHVPbkNsb3NlU3Vic2NyaWJlcixcblx0XHRcdHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgpID0+IEx1VXNlclBhZ2VkU2VhcmNoZXJDb21wb25lbnQpLFxuXHRcdFx0bXVsdGk6IHRydWUsXG5cdFx0fSxcblx0XHR7XG5cdFx0XHRwcm92aWRlOiBBTHVPblNjcm9sbEJvdHRvbVN1YnNjcmliZXIsXG5cdFx0XHR1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBMdVVzZXJQYWdlZFNlYXJjaGVyQ29tcG9uZW50KSxcblx0XHRcdG11bHRpOiB0cnVlLFxuXHRcdH0sXG5cdFx0e1xuXHRcdFx0cHJvdmlkZTogQUx1VXNlclNlcnZpY2UsXG5cdFx0XHR1c2VDbGFzczogTHVVc2VyVjNTZXJ2aWNlLFxuXHRcdH0sXG5cdF0sXG59KVxuZXhwb3J0IGNsYXNzIEx1VXNlclBhZ2VkU2VhcmNoZXJDb21wb25lbnQ8VSBleHRlbmRzIElMdVVzZXIgPSBJTHVVc2VyPiBpbXBsZW1lbnRzIE9uSW5pdCwgT25EZXN0cm95LCBJTHVPbk9wZW5TdWJzY3JpYmVyLCBJTHVPblNjcm9sbEJvdHRvbVN1YnNjcmliZXIsIElMdU9uQ2xvc2VTdWJzY3JpYmVyIHtcblx0cHJpdmF0ZSBfc2VydmljZTogTHVVc2VyVjNTZXJ2aWNlPFU+O1xuXHRwcml2YXRlIF9zdWJzID0gbmV3IFN1YnNjcmlwdGlvbigpO1xuXG5cdEBIb3N0QmluZGluZygnY2xhc3MucG9zaXRpb24tZml4ZWQnKSBmaXhlZCA9IHRydWU7XG5cdEBWaWV3Q2hpbGQoJ3NlYXJjaElucHV0JywgeyByZWFkOiBFbGVtZW50UmVmLCBzdGF0aWM6IHRydWUgfSlcblx0c2VhcmNoSW5wdXQ6IEVsZW1lbnRSZWY8SFRNTElucHV0RWxlbWVudD47XG5cblx0QElucHV0KCkgc2V0IGZpZWxkcyhmaWVsZHM6IHN0cmluZykge1xuXHRcdHRoaXMuX3NlcnZpY2UuZmllbGRzID0gZmllbGRzO1xuXHR9XG5cdEBJbnB1dCgpIHNldCBmaWx0ZXJzKGZpbHRlcnM6IHN0cmluZ1tdKSB7XG5cdFx0dGhpcy5fc2VydmljZS5maWx0ZXJzID0gZmlsdGVycztcblx0fVxuXHRASW5wdXQoKSBzZXQgb3JkZXJCeShvcmRlckJ5OiBzdHJpbmcpIHtcblx0XHR0aGlzLl9zZXJ2aWNlLm9yZGVyQnkgPSBvcmRlckJ5O1xuXHR9XG5cdEBJbnB1dCgpIHNldCBhcHBJbnN0YW5jZUlkKGFwcEluc3RhbmNlSWQ6IG51bWJlciB8IHN0cmluZykge1xuXHRcdHRoaXMuX3NlcnZpY2UuYXBwSW5zdGFuY2VJZCA9IGFwcEluc3RhbmNlSWQ7XG5cdH1cblx0QElucHV0KCkgc2V0IG9wZXJhdGlvbnMob3BlcmF0aW9uczogbnVtYmVyW10pIHtcblx0XHR0aGlzLl9zZXJ2aWNlLm9wZXJhdGlvbnMgPSBvcGVyYXRpb25zO1xuXHR9XG5cdEBJbnB1dCgpIGVuYWJsZUZvcm1lckVtcGxveWVlcyA9IGZhbHNlO1xuXG5cdEBPdXRwdXQoKSBjbHVlQ2hhbmdlOiBPYnNlcnZhYmxlPHN0cmluZz47XG5cblx0Zm9ybTogRm9ybUdyb3VwO1xuXHQvLyBwYWdlJDogU3ViamVjdDxudW1iZXI+O1xuXHRvdXRPcHRpb25zJCA9IG5ldyBTdWJqZWN0PFVbXT4oKTtcblx0bG9hZGluZyQ6IE9ic2VydmFibGU8Ym9vbGVhbj47XG5cdGVtcHR5JDogT2JzZXJ2YWJsZTxib29sZWFuPjtcblx0cHJpdmF0ZSBfbG9hZGluZyA9IGZhbHNlO1xuXHRwcml2YXRlIF9pc09wZW5lZCQgPSBuZXcgQmVoYXZpb3JTdWJqZWN0KGZhbHNlKTtcblx0cHJpdmF0ZSBfcGFnZSQgPSBuZXcgU3ViamVjdDx2b2lkPigpO1xuXHRwcml2YXRlIF9pc0xhc3RQYWdlOiBib29sZWFuO1xuXHRwcml2YXRlIF9vcHRpb25zOiBVW10gPSBbXTtcblxuXHRwdWJsaWMgaW50bCA9IGdldEludGwoTFVfVVNFUl9TRUFSQ0hFUl9UUkFOU0xBVElPTlMpO1xuXG5cdGNvbnN0cnVjdG9yKEBJbmplY3QoQUx1VXNlclNlcnZpY2UpIEBPcHRpb25hbCgpIEBTa2lwU2VsZigpIGhvc3RTZXJ2aWNlOiBMdVVzZXJWM1NlcnZpY2U8VT4sIEBJbmplY3QoQUx1VXNlclNlcnZpY2UpIEBTZWxmKCkgc2VsZlNlcnZpY2U6IEx1VXNlclYzU2VydmljZTxVPikge1xuXHRcdHRoaXMuX3NlcnZpY2UgPSBob3N0U2VydmljZSB8fCBzZWxmU2VydmljZTtcblxuXHRcdGNvbnN0IGNsdWU6IEZvcm1Db250cm9sID0gbmV3IEZvcm1Db250cm9sKCcnKTtcblxuXHRcdHRoaXMuZm9ybSA9IG5ldyBGb3JtR3JvdXAoe1xuXHRcdFx0Y2x1ZSxcblx0XHRcdGZvcm1lckVtcGxveWVlczogbmV3IEZvcm1Db250cm9sKGZhbHNlKSxcblx0XHR9KTtcblxuXHRcdHRoaXMuY2x1ZUNoYW5nZSA9IGNsdWUudmFsdWVDaGFuZ2VzIGFzIE9ic2VydmFibGU8c3RyaW5nPjtcblx0fVxuXG5cdG5nT25Jbml0KCkge1xuXHRcdGNvbnN0IGZvcm1WYWx1ZSQgPSB0aGlzLmZvcm0udmFsdWVDaGFuZ2VzLnBpcGUoc3RhcnRXaXRoKHRoaXMuZm9ybS52YWx1ZSkpIGFzIE9ic2VydmFibGU8VXNlclBhZ2VkU2VhcmNoZXJGb3JtPjtcblxuXHRcdGNvbnN0IHBhZ2VyJCA9IHRoaXMuX3BhZ2UkLnBpcGUoXG5cdFx0XHRzY2FuKChhY2MpID0+IGFjYyArIDEsIDApLFxuXHRcdFx0c3RhcnRXaXRoKDApLFxuXHRcdCk7XG5cblx0XHRjb25zdCBxdWVyeSQgPSBjb21iaW5lTGF0ZXN0KFtmb3JtVmFsdWUkLnBpcGUoZGVib3VuY2VUaW1lKDI1MCkpLCB0aGlzLl9pc09wZW5lZCRdKS5waXBlKFxuXHRcdFx0ZmlsdGVyKChbLCBpc09wZW5lZF0pID0+IGlzT3BlbmVkKSxcblx0XHRcdHN3aXRjaE1hcCgoW3ZhbF0pID0+IHBhZ2VyJC5waXBlKG1hcDxudW1iZXIsIFtVc2VyUGFnZWRTZWFyY2hlckZvcm0sIG51bWJlcl0+KChwYWdlKSA9PiBbdmFsLCBwYWdlXSkpKSxcblx0XHRcdHNoYXJlKCksXG5cdFx0KTtcblxuXHRcdGNvbnN0IHJlc3VsdHMkID0gcXVlcnkkLnBpcGUoXG5cdFx0XHRzd2l0Y2hNYXAoKFt2YWwsIHBhZ2VdKSA9PiB7XG5cdFx0XHRcdGNvbnN0IGZpbHRlcnM6IHN0cmluZ1tdID0gW107XG5cdFx0XHRcdGlmICh2YWwuZm9ybWVyRW1wbG95ZWVzKSB7XG5cdFx0XHRcdFx0ZmlsdGVycy5wdXNoKGBmb3JtZXJFbXBsb3llZXM9dHJ1ZWApO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiB0aGlzLl9zZXJ2aWNlLnNlYXJjaFBhZ2VkKHZhbC5jbHVlLCBwYWdlLCBmaWx0ZXJzKS5waXBlKFxuXHRcdFx0XHRcdGNhdGNoRXJyb3IoKCkgPT4gb2YoW10pKSxcblx0XHRcdFx0XHRtYXA8VVtdLCBbVVtdLCBudW1iZXJdPigoaXRlbXMpID0+IFtpdGVtcywgcGFnZV0pLFxuXHRcdFx0XHQpO1xuXHRcdFx0fSksXG5cdFx0XHRzaGFyZSgpLFxuXHRcdCk7XG5cblx0XHRjb25zdCByZXN1bHRzU3ViID0gcmVzdWx0cyQuc3Vic2NyaWJlKChbaXRlbXMsIHBhZ2VdKSA9PiB7XG5cdFx0XHRpZiAocGFnZSA9PT0gMCkge1xuXHRcdFx0XHR0aGlzLl9vcHRpb25zID0gWy4uLml0ZW1zXTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuX29wdGlvbnMucHVzaCguLi5pdGVtcyk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLl9pc0xhc3RQYWdlID0gIWl0ZW1zLmxlbmd0aDtcblx0XHRcdHRoaXMub3V0T3B0aW9ucyQubmV4dChbLi4udGhpcy5fb3B0aW9uc10pO1xuXHRcdH0pO1xuXHRcdHRoaXMuX3N1YnMuYWRkKHJlc3VsdHNTdWIpO1xuXG5cdFx0dGhpcy5sb2FkaW5nJCA9IG1lcmdlKHF1ZXJ5JC5waXBlKG1hcCgoKSA9PiB0cnVlKSksIHJlc3VsdHMkLnBpcGUobWFwKCgpID0+IGZhbHNlKSkpO1xuXHRcdGNvbnN0IGxvYWRpbmdTdWIgPSB0aGlzLmxvYWRpbmckLnN1YnNjcmliZSgobCkgPT4gKHRoaXMuX2xvYWRpbmcgPSBsKSk7XG5cdFx0dGhpcy5fc3Vicy5hZGQobG9hZGluZ1N1Yik7XG5cblx0XHR0aGlzLmVtcHR5JCA9IHRoaXMub3V0T3B0aW9ucyQucGlwZShtYXAoKG8pID0+IG8ubGVuZ3RoID09PSAwKSk7XG5cdH1cblx0bmdPbkRlc3Ryb3koKSB7XG5cdFx0dGhpcy5fc3Vicy51bnN1YnNjcmliZSgpO1xuXHR9XG5cblx0b25PcGVuKCkge1xuXHRcdHRoaXMuc2VhcmNoSW5wdXQubmF0aXZlRWxlbWVudC5mb2N1cygpO1xuXHRcdHRoaXMuX2lzT3BlbmVkJC5uZXh0KHRydWUpO1xuXHR9XG5cdG9uU2Nyb2xsQm90dG9tKCkge1xuXHRcdGlmICghdGhpcy5fbG9hZGluZyAmJiAhdGhpcy5faXNMYXN0UGFnZSkge1xuXHRcdFx0dGhpcy5fcGFnZSQubmV4dCgpO1xuXHRcdH1cblx0fVxuXHRvbkNsb3NlKCkge1xuXHRcdHRoaXMuX2lzT3BlbmVkJC5uZXh0KGZhbHNlKTtcblx0XHR0aGlzLm91dE9wdGlvbnMkLm5leHQoW10pO1xuXHRcdHRoaXMucmVzZXQoKTtcblx0fVxuXG5cdHJlc2V0KCkge1xuXHRcdGlmICh0aGlzLmZvcm0uZGlydHkpIHtcblx0XHRcdHRoaXMuZm9ybS5yZXNldCgpO1xuXHRcdH1cblx0fVxufVxuIiwiPGZvcm0gW2Zvcm1Hcm91cF09XCJmb3JtXCI+XG5cdDxkaXYgY2xhc3M9XCJ0ZXh0ZmllbGQgbW9kLXNlYXJjaFwiIFtjbGFzcy5pcy1sb2FkaW5nXT1cImxvYWRpbmckIHwgYXN5bmNcIj5cblx0XHQ8aW5wdXQgI3NlYXJjaElucHV0IGNsYXNzPVwidGV4dGZpZWxkLWlucHV0XCIgZm9ybUNvbnRyb2xOYW1lPVwiY2x1ZVwiIC8+XG5cdDwvZGl2PlxuXG5cdDxsYWJlbCBjbGFzcz1cImNoZWNrYm94IG1vZC1mb3JtZXJFbXBsb3llZSBtb2QtU1wiICpuZ0lmPVwiZW5hYmxlRm9ybWVyRW1wbG95ZWVzXCI+XG5cdFx0PGlucHV0IGNsYXNzPVwiY2hlY2tib3gtaW5wdXRcIiB0eXBlPVwiY2hlY2tib3hcIiBmb3JtQ29udHJvbE5hbWU9XCJmb3JtZXJFbXBsb3llZXNcIiAvPlxuXHRcdDxzcGFuIGNsYXNzPVwiY2hlY2tib3gtbGFiZWxcIj57eyBpbnRsLmluY2x1ZGVGb3JtZXJFbXBsb3llZXMgfX08L3NwYW4+XG5cdDwvbGFiZWw+XG48L2Zvcm0+XG5cbjxsdS1vcHRpb24tcGxhY2Vob2xkZXIgKm5nSWY9XCIoZW1wdHkkIHwgYXN5bmMpICYmIChsb2FkaW5nJCB8IGFzeW5jKSA9PT0gZmFsc2VcIiAob25DbGVhcik9XCJyZXNldCgpXCI+PC9sdS1vcHRpb24tcGxhY2Vob2xkZXI+XG4iXX0=