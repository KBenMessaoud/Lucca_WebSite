/* eslint-disable @angular-eslint/no-output-native */
import { A11yModule } from '@angular/cdk/a11y';
import { OverlayModule } from '@angular/cdk/overlay';
import { CommonModule, DOCUMENT } from '@angular/common';
import { ChangeDetectionStrategy, Component, ContentChildren, Directive, EventEmitter, forwardRef, Inject, Input, Output, TemplateRef, ViewChild, } from '@angular/core';
import { ALuPickerPanel } from '@lucca-front/ng/picker';
import { luTransformPopover } from '@lucca-front/ng/popover';
import { merge, of } from 'rxjs';
import { delay, map, share } from 'rxjs/operators';
import { LuOptionItemComponent } from '../item';
import { ALuOptionItem } from '../item/option-item.model';
import { ALuOptionPicker } from './option-picker.model';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
import * as i2 from "@angular/cdk/a11y";
class ALuOptionPickerComponent extends ALuOptionPicker {
    /**
     * This method takes classes set on the host lu-popover element and applies them on the
     * popover template that displays in the overlay container.  Otherwise, it's difficult
     * to style the containing popover from outside the component.
     * @param classes list of class names
     */
    set inputPanelClasses(classes) {
        this.panelClasses = classes;
    }
    /**
     * This method takes classes set on the host lu-popover element and applies them on the
     * popover template that displays in the overlay container. Otherwise, it's difficult
     * to style the containing popover from outside the component.
     * @param classes list of class names
     */
    set inputContentClasses(classes) {
        this.contentClasses = classes;
    }
    /**
     * This method take a function that compare options from feeder and options from form value.
     * By default, compare JSON values.
     */
    set inputOptionComparer(comparer) {
        this.optionComparer = comparer;
    }
    set optionsQL(ql) {
        this._optionsQL = ql;
    }
    constructor(_changeDetectorRef, document) {
        super();
        this._changeDetectorRef = _changeDetectorRef;
        this.document = document;
        this.close = new EventEmitter();
        this.open = new EventEmitter();
        this.hovered = new EventEmitter();
        // eslint-disable-next-line @angular-eslint/no-output-on-prefix
        this.onSelectValue = new EventEmitter();
        this._defaultOverlayPaneClasses = ['mod-optionPicker'];
        this._options = [];
        this._highlightIndex = -1;
        this._isOptionItemsInitialized = false;
        this.overlayPaneClass = this._defaultOverlayPaneClasses;
    }
    _emitSelectValue(val) {
        this.onSelectValue.emit(val);
    }
    ngOnDestroy() {
        super.destroy();
    }
    _emitOpenEvent() {
        this.open.emit();
    }
    _emitCloseEvent() {
        this.close.emit();
    }
    _emitHoveredEvent(h) {
        this.hovered.emit(h);
    }
    onOpen() {
        super.onOpen();
        this.highlightIndex = -1;
        this._incrHighlight();
        this._applySelected();
    }
    set vcTemplateRef(tr) {
        this.templateRef = tr;
    }
    // keydown
    _handleKeydown(event) {
        super._handleKeydown(event);
        switch (event.key) {
            case 'Enter':
                this._selectHighlighted();
                event.preventDefault();
                event.stopPropagation();
                break;
            case 'ArrowUp':
                this._decrHighlight();
                event.preventDefault();
                event.stopPropagation();
                break;
            case 'ArrowDown':
                this._incrHighlight();
                event.preventDefault();
                event.stopPropagation();
                break;
        }
    }
    get highlightIndex() {
        return this._highlightIndex;
    }
    set highlightIndex(i) {
        this._highlightIndex = i;
        this._applyHighlight(true);
    }
    _initHighlight() {
        this._subs.add(this._options$.subscribe((options) => {
            const optionCount = options.length;
            const newHighlight = Math.max(Math.min(this.highlightIndex, optionCount - 1), -1);
            if (newHighlight !== this.highlightIndex) {
                this.highlightIndex = newHighlight;
            }
        }));
        setTimeout(() => {
            this.highlightIndex = -1;
        }, 1);
    }
    _incrHighlight() {
        const nextIndex = this._options.findIndex((item, index) => index > this.highlightIndex && !item.disabled);
        this.highlightIndex = nextIndex > -1 ? nextIndex : this._options.findIndex((item) => !item.disabled);
    }
    _decrHighlight() {
        //NB: findLastIndex would be better but is not available on this project
        let nextIndex = -1;
        for (let i = this.highlightIndex - 1; i >= 0; --i) {
            if (!this._options[i].disabled) {
                nextIndex = i;
                break;
            }
        }
        if (nextIndex > -1) {
            this.highlightIndex = nextIndex;
            return;
        }
        const optionsLength = this._options.length - 1;
        for (let i = optionsLength; i >= 0; --i) {
            if (!this._options[i].disabled) {
                nextIndex = i;
                break;
            }
        }
        this.highlightIndex = nextIndex;
    }
    _applyHighlight(reScroll = false) {
        if (!this.isOpen) {
            return;
        }
        const options = this._options;
        // remove `is-highlighted` class from all other options
        options.forEach((option) => (option.highlighted = false));
        // apply `is-highlighted` to current highlight
        const highlightedOption = options[this.highlightIndex];
        if (highlightedOption) {
            highlightedOption.highlighted = true;
            // scroll to let the highlighted option visible
            if (reScroll) {
                setTimeout(() => {
                    this._scrollToHighlight(highlightedOption.element.nativeElement);
                }, 1);
            }
        }
        this._changeDetectorRef.markForCheck();
    }
    _scrollToHighlight(targetElt) {
        if (!targetElt) {
            return;
        }
        const contentElt = this.document.querySelector('.lu-picker-content');
        if (!contentElt) {
            return;
        }
        const headerElt = this.document.querySelector('.lu-picker-content .lu-picker-header');
        const headerHeight = headerElt ? headerElt.offsetHeight : 0;
        const footerElt = this.document.querySelector('.lu-picker-content .lu-picker-footer');
        const footerHeight = footerElt ? footerElt.offsetHeight : 0;
        // highlighted option is too high
        if (contentElt.scrollTop + headerHeight > targetElt.offsetTop) {
            contentElt.scrollTop = targetElt.offsetTop - headerHeight;
            return;
        }
        // highlight option is too low
        const offsetHeight = contentElt.offsetHeight;
        if (contentElt.scrollTop + offsetHeight - footerHeight < targetElt.offsetTop + targetElt.offsetHeight) {
            contentElt.scrollTop = targetElt.offsetTop + targetElt.offsetHeight - offsetHeight + footerHeight;
            return;
        }
    }
    _selectHighlighted() {
        const options = this._options ? this._options : [];
        const highlightedOption = options[this.highlightIndex];
        if (highlightedOption) {
            this._toggle(highlightedOption);
        }
    }
    _initSelected() {
        this._subs.add(this._options$.subscribe(() => {
            this._applySelected();
        }));
    }
    _applySelected() {
        if (!this._options) {
            return;
        }
        // const selectedClass = 'is-selected';
        const options = this._options;
        // remove `is-selected` class from all other options
        options.forEach((option) => (option.selected = false));
        // add `is-selected` to all selected indexes
        const selectedIndexes = [];
        if (!this.multiple) {
            const selectedIndex = this._options.findIndex((o) => this.optionComparer(o.value, this._value));
            if (selectedIndex !== -1) {
                selectedIndexes.push(selectedIndex);
            }
            if (selectedIndex !== -1 && this.highlightIndex === -1) {
                this.highlightIndex = selectedIndex;
            }
        }
        else {
            const values = this._value || [];
            const matchingIndexes = this._options
                .map((o) => values.some((v) => this.optionComparer(o.value, v)))
                .map((f, i) => (f ? i : null))
                .filter((i) => i !== null);
            selectedIndexes.push(...matchingIndexes);
            // selectedIndexes.push(
            // 	...values
            // 	.map(v => this._options.findIndex(o => this.optionComparer(o.value, v)))
            // 	.filter(i => i !== -1)
            // );
        }
        selectedIndexes.forEach((i) => {
            const option = options[i];
            if (option) {
                option.selected = true;
            }
        });
    }
    initItems() {
        const items$ = merge(of(this._optionsQL), this._optionsQL.changes).pipe(map((q) => q.toArray()), delay(0), share());
        items$.subscribe((o) => (this._options = o || []));
        this._options$ = items$;
        this._initHighlight();
        this._initSelected();
    }
    ngAfterViewInit() {
        this.initItems();
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.3", ngImport: i0, type: ALuOptionPickerComponent, deps: [{ token: i0.ChangeDetectorRef }, { token: DOCUMENT }], target: i0.ɵɵFactoryTarget.Directive }); }
    static { this.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "14.0.0", version: "16.1.3", type: ALuOptionPickerComponent, inputs: { inputPanelClasses: ["panel-classes", "inputPanelClasses"], inputContentClasses: ["content-classes", "inputContentClasses"], inputOptionComparer: ["option-comparer", "inputOptionComparer"] }, outputs: { close: "close", open: "open", hovered: "hovered", onSelectValue: "onSelectValue" }, queries: [{ propertyName: "optionsQL", predicate: ALuOptionItem, descendants: true }], viewQueries: [{ propertyName: "vcTemplateRef", first: true, predicate: TemplateRef, descendants: true, static: true }], usesInheritance: true, ngImport: i0 }); }
}
export { ALuOptionPickerComponent };
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.3", ngImport: i0, type: ALuOptionPickerComponent, decorators: [{
            type: Directive
        }], ctorParameters: function () { return [{ type: i0.ChangeDetectorRef }, { type: Document, decorators: [{
                    type: Inject,
                    args: [DOCUMENT]
                }] }]; }, propDecorators: { inputPanelClasses: [{
                type: Input,
                args: ['panel-classes']
            }], inputContentClasses: [{
                type: Input,
                args: ['content-classes']
            }], inputOptionComparer: [{
                type: Input,
                args: ['option-comparer']
            }], close: [{
                type: Output
            }], open: [{
                type: Output
            }], hovered: [{
                type: Output
            }], onSelectValue: [{
                type: Output
            }], optionsQL: [{
                type: ContentChildren,
                args: [ALuOptionItem, { descendants: true }]
            }], vcTemplateRef: [{
                type: ViewChild,
                args: [TemplateRef, { static: true }]
            }] } });
/**
 * basic option picker panel
 */
class LuOptionPickerComponent extends ALuOptionPickerComponent {
    constructor(_changeDetectorRef, document) {
        super(_changeDetectorRef, document);
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.3", ngImport: i0, type: LuOptionPickerComponent, deps: [{ token: i0.ChangeDetectorRef }, { token: DOCUMENT }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.3", type: LuOptionPickerComponent, isStandalone: true, selector: "lu-option-picker", providers: [
            {
                provide: ALuPickerPanel,
                useExisting: forwardRef(() => LuOptionPickerComponent),
            },
        ], exportAs: ["LuOptionPicker"], usesInheritance: true, ngImport: i0, template: "<ng-template>\n\t<div\n\t\tclass=\"lu-picker-panel lu-option-picker-panel\"\n\t\trole=\"dialog\"\n\t\t[ngClass]=\"panelClassesMap\"\n\t\t[class.mod-multiple]=\"multiple\"\n\t\t(click)=\"onClick()\"\n\t\t(mouseover)=\"onMouseOver()\"\n\t\t(mouseleave)=\"onMouseLeave()\"\n\t\t(mousedown)=\"onMouseDown()\"\n\t>\n\t\t<div class=\"lu-picker-content\" [ngClass]=\"contentClassesMap\" [cdkTrapFocus]=\"trapFocus\">\n\t\t\t<div class=\"lu-picker-content-option\">\n\t\t\t\t<ng-content></ng-content>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</ng-template>\n", dependencies: [{ kind: "ngmodule", type: CommonModule }, { kind: "directive", type: i1.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "ngmodule", type: OverlayModule }, { kind: "ngmodule", type: A11yModule }, { kind: "directive", type: i2.CdkTrapFocus, selector: "[cdkTrapFocus]", inputs: ["cdkTrapFocus", "cdkTrapFocusAutoCapture"], exportAs: ["cdkTrapFocus"] }], animations: [luTransformPopover], changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
export { LuOptionPickerComponent };
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.3", ngImport: i0, type: LuOptionPickerComponent, decorators: [{
            type: Component,
            args: [{ selector: 'lu-option-picker', changeDetection: ChangeDetectionStrategy.OnPush, animations: [luTransformPopover], exportAs: 'LuOptionPicker', standalone: true, imports: [CommonModule, OverlayModule, LuOptionItemComponent, A11yModule], providers: [
                        {
                            provide: ALuPickerPanel,
                            useExisting: forwardRef(() => LuOptionPickerComponent),
                        },
                    ], template: "<ng-template>\n\t<div\n\t\tclass=\"lu-picker-panel lu-option-picker-panel\"\n\t\trole=\"dialog\"\n\t\t[ngClass]=\"panelClassesMap\"\n\t\t[class.mod-multiple]=\"multiple\"\n\t\t(click)=\"onClick()\"\n\t\t(mouseover)=\"onMouseOver()\"\n\t\t(mouseleave)=\"onMouseLeave()\"\n\t\t(mousedown)=\"onMouseDown()\"\n\t>\n\t\t<div class=\"lu-picker-content\" [ngClass]=\"contentClassesMap\" [cdkTrapFocus]=\"trapFocus\">\n\t\t\t<div class=\"lu-picker-content-option\">\n\t\t\t\t<ng-content></ng-content>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</ng-template>\n" }]
        }], ctorParameters: function () { return [{ type: i0.ChangeDetectorRef }, { type: Document, decorators: [{
                    type: Inject,
                    args: [DOCUMENT]
                }] }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib3B0aW9uLXBpY2tlci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wYWNrYWdlcy9uZy9vcHRpb24vcGlja2VyL29wdGlvbi1waWNrZXIuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vcGFja2FnZXMvbmcvb3B0aW9uL3BpY2tlci9vcHRpb24tcGlja2VyLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLHFEQUFxRDtBQUNyRCxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDL0MsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQ3JELE9BQU8sRUFBRSxZQUFZLEVBQUUsUUFBUSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDekQsT0FBTyxFQUVOLHVCQUF1QixFQUV2QixTQUFTLEVBQ1QsZUFBZSxFQUNmLFNBQVMsRUFDVCxZQUFZLEVBQ1osVUFBVSxFQUNWLE1BQU0sRUFDTixLQUFLLEVBRUwsTUFBTSxFQUVOLFdBQVcsRUFDWCxTQUFTLEdBQ1QsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQ3hELE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBQzdELE9BQU8sRUFBRSxLQUFLLEVBQUUsRUFBRSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ2pDLE9BQU8sRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLEtBQUssRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ25ELE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLFNBQVMsQ0FBQztBQUNoRCxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sMkJBQTJCLENBQUM7QUFDMUQsT0FBTyxFQUFFLGVBQWUsRUFBMEMsTUFBTSx1QkFBdUIsQ0FBQzs7OztBQUVoRyxNQUNzQix3QkFDckIsU0FBUSxlQUFx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QixnQkFBZ0IsY0FDZCxJQUFJLFdBQ1AsQ0FBQyxZQUFZLEVBQUUsYUFBYSxFQUFFLHFCQUFxQixFQUFFLFVBQVUsQ0FBQyxhQUM5RDt3QkFDVjs0QkFDQyxPQUFPLEVBQUUsY0FBYzs0QkFDdkIsV0FBVyxFQUFFLFVBQVUsQ0FBQyxHQUFHLEVBQUUsd0JBQXdCLENBQUM7eUJBQ3REO3FCQUNEOzswQkFHbUQsTUFBTTsyQkFBQyxRQUFRIiwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgQGFuZ3VsYXItZXNsaW50L25vLW91dHB1dC1uYXRpdmUgKi9cbmltcG9ydCB7IEExMXlNb2R1bGUgfSBmcm9tICdAYW5ndWxhci9jZGsvYTExeSc7XG5pbXBvcnQgeyBPdmVybGF5TW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvY2RrL292ZXJsYXknO1xuaW1wb3J0IHsgQ29tbW9uTW9kdWxlLCBET0NVTUVOVCB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQge1xuXHRBZnRlclZpZXdJbml0LFxuXHRDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSxcblx0Q2hhbmdlRGV0ZWN0b3JSZWYsXG5cdENvbXBvbmVudCxcblx0Q29udGVudENoaWxkcmVuLFxuXHREaXJlY3RpdmUsXG5cdEV2ZW50RW1pdHRlcixcblx0Zm9yd2FyZFJlZixcblx0SW5qZWN0LFxuXHRJbnB1dCxcblx0T25EZXN0cm95LFxuXHRPdXRwdXQsXG5cdFF1ZXJ5TGlzdCxcblx0VGVtcGxhdGVSZWYsXG5cdFZpZXdDaGlsZCxcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBBTHVQaWNrZXJQYW5lbCB9IGZyb20gJ0BsdWNjYS1mcm9udC9uZy9waWNrZXInO1xuaW1wb3J0IHsgbHVUcmFuc2Zvcm1Qb3BvdmVyIH0gZnJvbSAnQGx1Y2NhLWZyb250L25nL3BvcG92ZXInO1xuaW1wb3J0IHsgbWVyZ2UsIG9mIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBkZWxheSwgbWFwLCBzaGFyZSB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IEx1T3B0aW9uSXRlbUNvbXBvbmVudCB9IGZyb20gJy4uL2l0ZW0nO1xuaW1wb3J0IHsgQUx1T3B0aW9uSXRlbSB9IGZyb20gJy4uL2l0ZW0vb3B0aW9uLWl0ZW0ubW9kZWwnO1xuaW1wb3J0IHsgQUx1T3B0aW9uUGlja2VyLCBJTHVPcHRpb25QaWNrZXJQYW5lbCwgTHVPcHRpb25Db21wYXJlciB9IGZyb20gJy4vb3B0aW9uLXBpY2tlci5tb2RlbCc7XG5cbkBEaXJlY3RpdmUoKVxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEFMdU9wdGlvblBpY2tlckNvbXBvbmVudDxULCBPIGV4dGVuZHMgaW1wb3J0KCcuLi9pdGVtL29wdGlvbi1pdGVtLm1vZGVsJykuSUx1T3B0aW9uSXRlbTxUPiA9IGltcG9ydCgnLi4vaXRlbS9vcHRpb24taXRlbS5tb2RlbCcpLklMdU9wdGlvbkl0ZW08VD4+XG5cdGV4dGVuZHMgQUx1T3B0aW9uUGlja2VyPFQsIE8+XG5cdGltcGxlbWVudHMgSUx1T3B0aW9uUGlja2VyUGFuZWw8VD4sIE9uRGVzdHJveSwgQWZ0ZXJWaWV3SW5pdFxue1xuXHQvKipcblx0ICogVGhpcyBtZXRob2QgdGFrZXMgY2xhc3NlcyBzZXQgb24gdGhlIGhvc3QgbHUtcG9wb3ZlciBlbGVtZW50IGFuZCBhcHBsaWVzIHRoZW0gb24gdGhlXG5cdCAqIHBvcG92ZXIgdGVtcGxhdGUgdGhhdCBkaXNwbGF5cyBpbiB0aGUgb3ZlcmxheSBjb250YWluZXIuICBPdGhlcndpc2UsIGl0J3MgZGlmZmljdWx0XG5cdCAqIHRvIHN0eWxlIHRoZSBjb250YWluaW5nIHBvcG92ZXIgZnJvbSBvdXRzaWRlIHRoZSBjb21wb25lbnQuXG5cdCAqIEBwYXJhbSBjbGFzc2VzIGxpc3Qgb2YgY2xhc3MgbmFtZXNcblx0ICovXG5cdEBJbnB1dCgncGFuZWwtY2xhc3NlcycpXG5cdHNldCBpbnB1dFBhbmVsQ2xhc3NlcyhjbGFzc2VzOiBzdHJpbmcpIHtcblx0XHR0aGlzLnBhbmVsQ2xhc3NlcyA9IGNsYXNzZXM7XG5cdH1cblx0LyoqXG5cdCAqIFRoaXMgbWV0aG9kIHRha2VzIGNsYXNzZXMgc2V0IG9uIHRoZSBob3N0IGx1LXBvcG92ZXIgZWxlbWVudCBhbmQgYXBwbGllcyB0aGVtIG9uIHRoZVxuXHQgKiBwb3BvdmVyIHRlbXBsYXRlIHRoYXQgZGlzcGxheXMgaW4gdGhlIG92ZXJsYXkgY29udGFpbmVyLiBPdGhlcndpc2UsIGl0J3MgZGlmZmljdWx0XG5cdCAqIHRvIHN0eWxlIHRoZSBjb250YWluaW5nIHBvcG92ZXIgZnJvbSBvdXRzaWRlIHRoZSBjb21wb25lbnQuXG5cdCAqIEBwYXJhbSBjbGFzc2VzIGxpc3Qgb2YgY2xhc3MgbmFtZXNcblx0ICovXG5cdEBJbnB1dCgnY29udGVudC1jbGFzc2VzJylcblx0c2V0IGlucHV0Q29udGVudENsYXNzZXMoY2xhc3Nlczogc3RyaW5nKSB7XG5cdFx0dGhpcy5jb250ZW50Q2xhc3NlcyA9IGNsYXNzZXM7XG5cdH1cblxuXHQvKipcblx0ICogVGhpcyBtZXRob2QgdGFrZSBhIGZ1bmN0aW9uIHRoYXQgY29tcGFyZSBvcHRpb25zIGZyb20gZmVlZGVyIGFuZCBvcHRpb25zIGZyb20gZm9ybSB2YWx1ZS5cblx0ICogQnkgZGVmYXVsdCwgY29tcGFyZSBKU09OIHZhbHVlcy5cblx0ICovXG5cdEBJbnB1dCgnb3B0aW9uLWNvbXBhcmVyJylcblx0c2V0IGlucHV0T3B0aW9uQ29tcGFyZXIoY29tcGFyZXI6IEx1T3B0aW9uQ29tcGFyZXI8VD4pIHtcblx0XHR0aGlzLm9wdGlvbkNvbXBhcmVyID0gY29tcGFyZXI7XG5cdH1cblxuXHRAT3V0cHV0KCkgb3ZlcnJpZGUgY2xvc2UgPSBuZXcgRXZlbnRFbWl0dGVyPHZvaWQ+KCk7XG5cdEBPdXRwdXQoKSBvdmVycmlkZSBvcGVuID0gbmV3IEV2ZW50RW1pdHRlcjx2b2lkPigpO1xuXHRAT3V0cHV0KCkgb3ZlcnJpZGUgaG92ZXJlZCA9IG5ldyBFdmVudEVtaXR0ZXI8Ym9vbGVhbj4oKTtcblx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEBhbmd1bGFyLWVzbGludC9uby1vdXRwdXQtb24tcHJlZml4XG5cdEBPdXRwdXQoKSBvdmVycmlkZSBvblNlbGVjdFZhbHVlID0gbmV3IEV2ZW50RW1pdHRlcjxUPigpO1xuXG5cdHByb3RlY3RlZCBfaXNPcHRpb25JdGVtc0luaXRpYWxpemVkOiBib29sZWFuO1xuXHRwcm90ZWN0ZWQgX2RlZmF1bHRPdmVybGF5UGFuZUNsYXNzZXMgPSBbJ21vZC1vcHRpb25QaWNrZXInXTtcblxuXHRwcm90ZWN0ZWQgX29wdGlvbnM6IE9bXSA9IFtdO1xuXHRwcm90ZWN0ZWQgX29wdGlvbnNRTDogUXVlcnlMaXN0PE8+O1xuXHRAQ29udGVudENoaWxkcmVuKEFMdU9wdGlvbkl0ZW0sIHsgZGVzY2VuZGFudHM6IHRydWUgfSkgc2V0IG9wdGlvbnNRTChxbDogUXVlcnlMaXN0PE8+KSB7XG5cdFx0dGhpcy5fb3B0aW9uc1FMID0gcWw7XG5cdH1cblxuXHRjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgX2NoYW5nZURldGVjdG9yUmVmOiBDaGFuZ2VEZXRlY3RvclJlZiwgQEluamVjdChET0NVTUVOVCkgcHJvdGVjdGVkIGRvY3VtZW50OiBEb2N1bWVudCkge1xuXHRcdHN1cGVyKCk7XG5cdFx0dGhpcy5faXNPcHRpb25JdGVtc0luaXRpYWxpemVkID0gZmFsc2U7XG5cdFx0dGhpcy5vdmVybGF5UGFuZUNsYXNzID0gdGhpcy5fZGVmYXVsdE92ZXJsYXlQYW5lQ2xhc3Nlcztcblx0fVxuXG5cdHByb3RlY3RlZCBfZW1pdFNlbGVjdFZhbHVlKHZhbDogVCkge1xuXHRcdHRoaXMub25TZWxlY3RWYWx1ZS5lbWl0KHZhbCk7XG5cdH1cblx0bmdPbkRlc3Ryb3koKSB7XG5cdFx0c3VwZXIuZGVzdHJveSgpO1xuXHR9XG5cdF9lbWl0T3BlbkV2ZW50KCk6IHZvaWQge1xuXHRcdHRoaXMub3Blbi5lbWl0KCk7XG5cdH1cblx0X2VtaXRDbG9zZUV2ZW50KCk6IHZvaWQge1xuXHRcdHRoaXMuY2xvc2UuZW1pdCgpO1xuXHR9XG5cdF9lbWl0SG92ZXJlZEV2ZW50KGg6IGJvb2xlYW4pOiB2b2lkIHtcblx0XHR0aGlzLmhvdmVyZWQuZW1pdChoKTtcblx0fVxuXHRvdmVycmlkZSBvbk9wZW4oKSB7XG5cdFx0c3VwZXIub25PcGVuKCk7XG5cdFx0dGhpcy5oaWdobGlnaHRJbmRleCA9IC0xO1xuXHRcdHRoaXMuX2luY3JIaWdobGlnaHQoKTtcblx0XHR0aGlzLl9hcHBseVNlbGVjdGVkKCk7XG5cdH1cblx0QFZpZXdDaGlsZChUZW1wbGF0ZVJlZiwgeyBzdGF0aWM6IHRydWUgfSlcblx0c2V0IHZjVGVtcGxhdGVSZWYodHI6IFRlbXBsYXRlUmVmPEhUTUxFbGVtZW50Pikge1xuXHRcdHRoaXMudGVtcGxhdGVSZWYgPSB0cjtcblx0fVxuXG5cdC8vIGtleWRvd25cblx0b3ZlcnJpZGUgX2hhbmRsZUtleWRvd24oZXZlbnQ6IEtleWJvYXJkRXZlbnQpIHtcblx0XHRzdXBlci5faGFuZGxlS2V5ZG93bihldmVudCk7XG5cdFx0c3dpdGNoIChldmVudC5rZXkpIHtcblx0XHRcdGNhc2UgJ0VudGVyJzpcblx0XHRcdFx0dGhpcy5fc2VsZWN0SGlnaGxpZ2h0ZWQoKTtcblx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0ZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSAnQXJyb3dVcCc6XG5cdFx0XHRcdHRoaXMuX2RlY3JIaWdobGlnaHQoKTtcblx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0ZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSAnQXJyb3dEb3duJzpcblx0XHRcdFx0dGhpcy5faW5jckhpZ2hsaWdodCgpO1xuXHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0fVxuXHR9XG5cdHByb3RlY3RlZCBfaGlnaGxpZ2h0SW5kZXggPSAtMTtcblx0Z2V0IGhpZ2hsaWdodEluZGV4KCkge1xuXHRcdHJldHVybiB0aGlzLl9oaWdobGlnaHRJbmRleDtcblx0fVxuXHRzZXQgaGlnaGxpZ2h0SW5kZXgoaTogbnVtYmVyKSB7XG5cdFx0dGhpcy5faGlnaGxpZ2h0SW5kZXggPSBpO1xuXHRcdHRoaXMuX2FwcGx5SGlnaGxpZ2h0KHRydWUpO1xuXHR9XG5cdHByb3RlY3RlZCBfaW5pdEhpZ2hsaWdodCgpIHtcblx0XHR0aGlzLl9zdWJzLmFkZChcblx0XHRcdHRoaXMuX29wdGlvbnMkLnN1YnNjcmliZSgob3B0aW9ucykgPT4ge1xuXHRcdFx0XHRjb25zdCBvcHRpb25Db3VudCA9IG9wdGlvbnMubGVuZ3RoO1xuXHRcdFx0XHRjb25zdCBuZXdIaWdobGlnaHQgPSBNYXRoLm1heChNYXRoLm1pbih0aGlzLmhpZ2hsaWdodEluZGV4LCBvcHRpb25Db3VudCAtIDEpLCAtMSk7XG5cdFx0XHRcdGlmIChuZXdIaWdobGlnaHQgIT09IHRoaXMuaGlnaGxpZ2h0SW5kZXgpIHtcblx0XHRcdFx0XHR0aGlzLmhpZ2hsaWdodEluZGV4ID0gbmV3SGlnaGxpZ2h0O1xuXHRcdFx0XHR9XG5cdFx0XHR9KSxcblx0XHQpO1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dGhpcy5oaWdobGlnaHRJbmRleCA9IC0xO1xuXHRcdH0sIDEpO1xuXHR9XG5cdHByb3RlY3RlZCBfaW5jckhpZ2hsaWdodCgpIHtcblx0XHRjb25zdCBuZXh0SW5kZXggPSB0aGlzLl9vcHRpb25zLmZpbmRJbmRleCgoaXRlbSwgaW5kZXgpID0+IGluZGV4ID4gdGhpcy5oaWdobGlnaHRJbmRleCAmJiAhaXRlbS5kaXNhYmxlZCk7XG5cdFx0dGhpcy5oaWdobGlnaHRJbmRleCA9IG5leHRJbmRleCA+IC0xID8gbmV4dEluZGV4IDogdGhpcy5fb3B0aW9ucy5maW5kSW5kZXgoKGl0ZW0pID0+ICFpdGVtLmRpc2FibGVkKTtcblx0fVxuXHRwcm90ZWN0ZWQgX2RlY3JIaWdobGlnaHQoKSB7XG5cdFx0Ly9OQjogZmluZExhc3RJbmRleCB3b3VsZCBiZSBiZXR0ZXIgYnV0IGlzIG5vdCBhdmFpbGFibGUgb24gdGhpcyBwcm9qZWN0XG5cdFx0bGV0IG5leHRJbmRleCA9IC0xO1xuXHRcdGZvciAobGV0IGkgPSB0aGlzLmhpZ2hsaWdodEluZGV4IC0gMTsgaSA+PSAwOyAtLWkpIHtcblx0XHRcdGlmICghdGhpcy5fb3B0aW9uc1tpXS5kaXNhYmxlZCkge1xuXHRcdFx0XHRuZXh0SW5kZXggPSBpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZiAobmV4dEluZGV4ID4gLTEpIHtcblx0XHRcdHRoaXMuaGlnaGxpZ2h0SW5kZXggPSBuZXh0SW5kZXg7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Y29uc3Qgb3B0aW9uc0xlbmd0aCA9IHRoaXMuX29wdGlvbnMubGVuZ3RoIC0gMTtcblx0XHRmb3IgKGxldCBpID0gb3B0aW9uc0xlbmd0aDsgaSA+PSAwOyAtLWkpIHtcblx0XHRcdGlmICghdGhpcy5fb3B0aW9uc1tpXS5kaXNhYmxlZCkge1xuXHRcdFx0XHRuZXh0SW5kZXggPSBpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHR9XG5cdFx0dGhpcy5oaWdobGlnaHRJbmRleCA9IG5leHRJbmRleDtcblx0fVxuXHRwcm90ZWN0ZWQgX2FwcGx5SGlnaGxpZ2h0KHJlU2Nyb2xsID0gZmFsc2UpIHtcblx0XHRpZiAoIXRoaXMuaXNPcGVuKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Y29uc3Qgb3B0aW9ucyA9IHRoaXMuX29wdGlvbnM7XG5cdFx0Ly8gcmVtb3ZlIGBpcy1oaWdobGlnaHRlZGAgY2xhc3MgZnJvbSBhbGwgb3RoZXIgb3B0aW9uc1xuXHRcdG9wdGlvbnMuZm9yRWFjaCgob3B0aW9uKSA9PiAob3B0aW9uLmhpZ2hsaWdodGVkID0gZmFsc2UpKTtcblx0XHQvLyBhcHBseSBgaXMtaGlnaGxpZ2h0ZWRgIHRvIGN1cnJlbnQgaGlnaGxpZ2h0XG5cdFx0Y29uc3QgaGlnaGxpZ2h0ZWRPcHRpb24gPSBvcHRpb25zW3RoaXMuaGlnaGxpZ2h0SW5kZXhdO1xuXG5cdFx0aWYgKGhpZ2hsaWdodGVkT3B0aW9uKSB7XG5cdFx0XHRoaWdobGlnaHRlZE9wdGlvbi5oaWdobGlnaHRlZCA9IHRydWU7XG5cdFx0XHQvLyBzY3JvbGwgdG8gbGV0IHRoZSBoaWdobGlnaHRlZCBvcHRpb24gdmlzaWJsZVxuXHRcdFx0aWYgKHJlU2Nyb2xsKSB7XG5cdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRcdHRoaXMuX3Njcm9sbFRvSGlnaGxpZ2h0KGhpZ2hsaWdodGVkT3B0aW9uLmVsZW1lbnQubmF0aXZlRWxlbWVudCk7XG5cdFx0XHRcdH0sIDEpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHR0aGlzLl9jaGFuZ2VEZXRlY3RvclJlZi5tYXJrRm9yQ2hlY2soKTtcblx0fVxuXHRwcm90ZWN0ZWQgX3Njcm9sbFRvSGlnaGxpZ2h0KHRhcmdldEVsdDogSFRNTEVsZW1lbnQpIHtcblx0XHRpZiAoIXRhcmdldEVsdCkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRjb25zdCBjb250ZW50RWx0ID0gdGhpcy5kb2N1bWVudC5xdWVyeVNlbGVjdG9yPEhUTUxFbGVtZW50PignLmx1LXBpY2tlci1jb250ZW50Jyk7XG5cdFx0aWYgKCFjb250ZW50RWx0KSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdGNvbnN0IGhlYWRlckVsdCA9IHRoaXMuZG9jdW1lbnQucXVlcnlTZWxlY3RvcjxIVE1MRWxlbWVudD4oJy5sdS1waWNrZXItY29udGVudCAubHUtcGlja2VyLWhlYWRlcicpO1xuXHRcdGNvbnN0IGhlYWRlckhlaWdodCA9IGhlYWRlckVsdCA/IGhlYWRlckVsdC5vZmZzZXRIZWlnaHQgOiAwO1xuXHRcdGNvbnN0IGZvb3RlckVsdCA9IHRoaXMuZG9jdW1lbnQucXVlcnlTZWxlY3RvcjxIVE1MRWxlbWVudD4oJy5sdS1waWNrZXItY29udGVudCAubHUtcGlja2VyLWZvb3RlcicpO1xuXHRcdGNvbnN0IGZvb3RlckhlaWdodCA9IGZvb3RlckVsdCA/IGZvb3RlckVsdC5vZmZzZXRIZWlnaHQgOiAwO1xuXHRcdC8vIGhpZ2hsaWdodGVkIG9wdGlvbiBpcyB0b28gaGlnaFxuXHRcdGlmIChjb250ZW50RWx0LnNjcm9sbFRvcCArIGhlYWRlckhlaWdodCA+IHRhcmdldEVsdC5vZmZzZXRUb3ApIHtcblx0XHRcdGNvbnRlbnRFbHQuc2Nyb2xsVG9wID0gdGFyZ2V0RWx0Lm9mZnNldFRvcCAtIGhlYWRlckhlaWdodDtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0Ly8gaGlnaGxpZ2h0IG9wdGlvbiBpcyB0b28gbG93XG5cdFx0Y29uc3Qgb2Zmc2V0SGVpZ2h0ID0gY29udGVudEVsdC5vZmZzZXRIZWlnaHQ7XG5cdFx0aWYgKGNvbnRlbnRFbHQuc2Nyb2xsVG9wICsgb2Zmc2V0SGVpZ2h0IC0gZm9vdGVySGVpZ2h0IDwgdGFyZ2V0RWx0Lm9mZnNldFRvcCArIHRhcmdldEVsdC5vZmZzZXRIZWlnaHQpIHtcblx0XHRcdGNvbnRlbnRFbHQuc2Nyb2xsVG9wID0gdGFyZ2V0RWx0Lm9mZnNldFRvcCArIHRhcmdldEVsdC5vZmZzZXRIZWlnaHQgLSBvZmZzZXRIZWlnaHQgKyBmb290ZXJIZWlnaHQ7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHR9XG5cdHByb3RlY3RlZCBfc2VsZWN0SGlnaGxpZ2h0ZWQoKSB7XG5cdFx0Y29uc3Qgb3B0aW9ucyA9IHRoaXMuX29wdGlvbnMgPyB0aGlzLl9vcHRpb25zIDogW107XG5cdFx0Y29uc3QgaGlnaGxpZ2h0ZWRPcHRpb24gPSBvcHRpb25zW3RoaXMuaGlnaGxpZ2h0SW5kZXhdO1xuXHRcdGlmIChoaWdobGlnaHRlZE9wdGlvbikge1xuXHRcdFx0dGhpcy5fdG9nZ2xlKGhpZ2hsaWdodGVkT3B0aW9uKTtcblx0XHR9XG5cdH1cblx0cHJvdGVjdGVkIF9pbml0U2VsZWN0ZWQoKSB7XG5cdFx0dGhpcy5fc3Vicy5hZGQoXG5cdFx0XHR0aGlzLl9vcHRpb25zJC5zdWJzY3JpYmUoKCkgPT4ge1xuXHRcdFx0XHR0aGlzLl9hcHBseVNlbGVjdGVkKCk7XG5cdFx0XHR9KSxcblx0XHQpO1xuXHR9XG5cdHByb3RlY3RlZCBfYXBwbHlTZWxlY3RlZCgpIHtcblx0XHRpZiAoIXRoaXMuX29wdGlvbnMpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0Ly8gY29uc3Qgc2VsZWN0ZWRDbGFzcyA9ICdpcy1zZWxlY3RlZCc7XG5cblx0XHRjb25zdCBvcHRpb25zID0gdGhpcy5fb3B0aW9ucztcblx0XHQvLyByZW1vdmUgYGlzLXNlbGVjdGVkYCBjbGFzcyBmcm9tIGFsbCBvdGhlciBvcHRpb25zXG5cdFx0b3B0aW9ucy5mb3JFYWNoKChvcHRpb24pID0+IChvcHRpb24uc2VsZWN0ZWQgPSBmYWxzZSkpO1xuXG5cdFx0Ly8gYWRkIGBpcy1zZWxlY3RlZGAgdG8gYWxsIHNlbGVjdGVkIGluZGV4ZXNcblx0XHRjb25zdCBzZWxlY3RlZEluZGV4ZXM6IG51bWJlcltdID0gW107XG5cdFx0aWYgKCF0aGlzLm11bHRpcGxlKSB7XG5cdFx0XHRjb25zdCBzZWxlY3RlZEluZGV4ID0gdGhpcy5fb3B0aW9ucy5maW5kSW5kZXgoKG8pID0+IHRoaXMub3B0aW9uQ29tcGFyZXIoby52YWx1ZSwgdGhpcy5fdmFsdWUgYXMgVCkpO1xuXHRcdFx0aWYgKHNlbGVjdGVkSW5kZXggIT09IC0xKSB7XG5cdFx0XHRcdHNlbGVjdGVkSW5kZXhlcy5wdXNoKHNlbGVjdGVkSW5kZXgpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKHNlbGVjdGVkSW5kZXggIT09IC0xICYmIHRoaXMuaGlnaGxpZ2h0SW5kZXggPT09IC0xKSB7XG5cdFx0XHRcdHRoaXMuaGlnaGxpZ2h0SW5kZXggPSBzZWxlY3RlZEluZGV4O1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zdCB2YWx1ZXMgPSA8VFtdPnRoaXMuX3ZhbHVlIHx8IFtdO1xuXHRcdFx0Y29uc3QgbWF0Y2hpbmdJbmRleGVzID0gdGhpcy5fb3B0aW9uc1xuXHRcdFx0XHQubWFwKChvKSA9PiB2YWx1ZXMuc29tZSgodikgPT4gdGhpcy5vcHRpb25Db21wYXJlcihvLnZhbHVlLCB2KSkpXG5cdFx0XHRcdC5tYXAoKGYsIGkpID0+IChmID8gaSA6IG51bGwpKVxuXHRcdFx0XHQuZmlsdGVyKChpKSA9PiBpICE9PSBudWxsKTtcblx0XHRcdHNlbGVjdGVkSW5kZXhlcy5wdXNoKC4uLm1hdGNoaW5nSW5kZXhlcyk7XG5cdFx0XHQvLyBzZWxlY3RlZEluZGV4ZXMucHVzaChcblx0XHRcdC8vIFx0Li4udmFsdWVzXG5cdFx0XHQvLyBcdC5tYXAodiA9PiB0aGlzLl9vcHRpb25zLmZpbmRJbmRleChvID0+IHRoaXMub3B0aW9uQ29tcGFyZXIoby52YWx1ZSwgdikpKVxuXHRcdFx0Ly8gXHQuZmlsdGVyKGkgPT4gaSAhPT0gLTEpXG5cdFx0XHQvLyApO1xuXHRcdH1cblx0XHRzZWxlY3RlZEluZGV4ZXMuZm9yRWFjaCgoaSkgPT4ge1xuXHRcdFx0Y29uc3Qgb3B0aW9uID0gb3B0aW9uc1tpXTtcblx0XHRcdGlmIChvcHRpb24pIHtcblx0XHRcdFx0b3B0aW9uLnNlbGVjdGVkID0gdHJ1ZTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdHByb3RlY3RlZCBpbml0SXRlbXMoKSB7XG5cdFx0Y29uc3QgaXRlbXMkID0gbWVyZ2Uob2YodGhpcy5fb3B0aW9uc1FMKSwgdGhpcy5fb3B0aW9uc1FMLmNoYW5nZXMpLnBpcGUoXG5cdFx0XHRtYXA8UXVlcnlMaXN0PE8+LCBPW10+KChxKSA9PiBxLnRvQXJyYXkoKSksXG5cdFx0XHRkZWxheSgwKSxcblx0XHRcdHNoYXJlKCksXG5cdFx0KTtcblx0XHRpdGVtcyQuc3Vic2NyaWJlKChvKSA9PiAodGhpcy5fb3B0aW9ucyA9IG8gfHwgW10pKTtcblx0XHR0aGlzLl9vcHRpb25zJCA9IGl0ZW1zJDtcblx0XHR0aGlzLl9pbml0SGlnaGxpZ2h0KCk7XG5cdFx0dGhpcy5faW5pdFNlbGVjdGVkKCk7XG5cdH1cblx0bmdBZnRlclZpZXdJbml0KCkge1xuXHRcdHRoaXMuaW5pdEl0ZW1zKCk7XG5cdH1cbn1cbi8qKlxuICogYmFzaWMgb3B0aW9uIHBpY2tlciBwYW5lbFxuICovXG5AQ29tcG9uZW50KHtcblx0c2VsZWN0b3I6ICdsdS1vcHRpb24tcGlja2VyJyxcblx0dGVtcGxhdGVVcmw6ICcuL29wdGlvbi1waWNrZXIuY29tcG9uZW50Lmh0bWwnLFxuXHRjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcblx0YW5pbWF0aW9uczogW2x1VHJhbnNmb3JtUG9wb3Zlcl0sXG5cdGV4cG9ydEFzOiAnTHVPcHRpb25QaWNrZXInLFxuXHRzdGFuZGFsb25lOiB0cnVlLFxuXHRpbXBvcnRzOiBbQ29tbW9uTW9kdWxlLCBPdmVybGF5TW9kdWxlLCBMdU9wdGlvbkl0ZW1Db21wb25lbnQsIEExMXlNb2R1bGVdLFxuXHRwcm92aWRlcnM6IFtcblx0XHR7XG5cdFx0XHRwcm92aWRlOiBBTHVQaWNrZXJQYW5lbCxcblx0XHRcdHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgpID0+IEx1T3B0aW9uUGlja2VyQ29tcG9uZW50KSxcblx0XHR9LFxuXHRdLFxufSlcbmV4cG9ydCBjbGFzcyBMdU9wdGlvblBpY2tlckNvbXBvbmVudDxULCBPIGV4dGVuZHMgaW1wb3J0KCcuLi9pdGVtL29wdGlvbi1pdGVtLm1vZGVsJykuSUx1T3B0aW9uSXRlbTxUPiA9IGltcG9ydCgnLi4vaXRlbS9vcHRpb24taXRlbS5tb2RlbCcpLklMdU9wdGlvbkl0ZW08VD4+IGV4dGVuZHMgQUx1T3B0aW9uUGlja2VyQ29tcG9uZW50PFQsIE8+IHtcblx0Y29uc3RydWN0b3IoX2NoYW5nZURldGVjdG9yUmVmOiBDaGFuZ2VEZXRlY3RvclJlZiwgQEluamVjdChET0NVTUVOVCkgZG9jdW1lbnQ6IERvY3VtZW50KSB7XG5cdFx0c3VwZXIoX2NoYW5nZURldGVjdG9yUmVmLCBkb2N1bWVudCk7XG5cdH1cbn1cbiIsIjxuZy10ZW1wbGF0ZT5cblx0PGRpdlxuXHRcdGNsYXNzPVwibHUtcGlja2VyLXBhbmVsIGx1LW9wdGlvbi1waWNrZXItcGFuZWxcIlxuXHRcdHJvbGU9XCJkaWFsb2dcIlxuXHRcdFtuZ0NsYXNzXT1cInBhbmVsQ2xhc3Nlc01hcFwiXG5cdFx0W2NsYXNzLm1vZC1tdWx0aXBsZV09XCJtdWx0aXBsZVwiXG5cdFx0KGNsaWNrKT1cIm9uQ2xpY2soKVwiXG5cdFx0KG1vdXNlb3Zlcik9XCJvbk1vdXNlT3ZlcigpXCJcblx0XHQobW91c2VsZWF2ZSk9XCJvbk1vdXNlTGVhdmUoKVwiXG5cdFx0KG1vdXNlZG93bik9XCJvbk1vdXNlRG93bigpXCJcblx0PlxuXHRcdDxkaXYgY2xhc3M9XCJsdS1waWNrZXItY29udGVudFwiIFtuZ0NsYXNzXT1cImNvbnRlbnRDbGFzc2VzTWFwXCIgW2Nka1RyYXBGb2N1c109XCJ0cmFwRm9jdXNcIj5cblx0XHRcdDxkaXYgY2xhc3M9XCJsdS1waWNrZXItY29udGVudC1vcHRpb25cIj5cblx0XHRcdFx0PG5nLWNvbnRlbnQ+PC9uZy1jb250ZW50PlxuXHRcdFx0PC9kaXY+XG5cdFx0PC9kaXY+XG5cdDwvZGl2PlxuPC9uZy10ZW1wbGF0ZT5cbiJdfQ==