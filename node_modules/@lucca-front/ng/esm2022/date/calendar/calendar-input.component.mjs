import { CommonModule, FormStyle, getLocaleDayNames, getLocaleFirstDayOfWeek, TranslationWidth } from '@angular/common';
import { ChangeDetectionStrategy, Component, forwardRef, Inject, Input, LOCALE_ID } from '@angular/core';
import { FormsModule, NG_VALIDATORS, NG_VALUE_ACCESSOR } from '@angular/forms';
import { ELuDateGranularity } from '@lucca-front/ng/core';
import { ALuInput } from '@lucca-front/ng/input';
import { LuCalendarItemFactory } from './calendar-item.factory';
import * as i0 from "@angular/core";
import * as i1 from "./calendar-item.factory";
import * as i2 from "@lucca-front/ng/core";
import * as i3 from "@angular/common";
class LuCalendarInputComponent extends ALuInput {
    get mod() {
        switch (this.viewGranularity) {
            case ELuDateGranularity.year:
                return 'mod-yearlyView';
            case ELuDateGranularity.month:
                return 'mod-monthlyView';
            case ELuDateGranularity.day:
            default:
                return 'mod-dailyView';
        }
    }
    constructor(_changeDetectorRef, _elementRef, _renderer, _locale, _factory, _adapter) {
        super(_changeDetectorRef, _elementRef, _renderer);
        this._locale = _locale;
        this._factory = _factory;
        this._adapter = _adapter;
        this.granularity = ELuDateGranularity.day;
        this.startOn = this._adapter.forgeToday();
        this.items = [];
        // daily view
        this.labels = [];
    }
    ngOnInit() {
        this.viewGranularity = this.granularity;
        this.initDayLabels();
    }
    writeValue(value) {
        const date = value && this._adapter.isValid(value) ? this._adapter.clone(value) : this.startOn;
        this.header = this._factory.forgeMonth(date);
        super.writeValue(value);
    }
    initDayLabels() {
        this.labels = [...getLocaleDayNames(this._locale, FormStyle.Standalone, TranslationWidth.Abbreviated)];
        if (getLocaleFirstDayOfWeek(this._locale) === 1) {
            this.labels.push(this.labels.shift());
        }
    }
    render() {
        switch (this.viewGranularity) {
            case ELuDateGranularity.year:
                this.renderYearlyView();
                break;
            case ELuDateGranularity.month:
                this.renderMonthlyView();
                break;
            case ELuDateGranularity.day:
            default:
                this.renderDailyView();
                break;
        }
    }
    renderDailyView(month = this.header.date) {
        this.items = [];
        const start = this._adapter.forge(this._adapter.getYear(month), this._adapter.getMonth(month), 1);
        let index = 0;
        const isFirstDayOfWeek = this._adapter.getDay(start) === getLocaleFirstDayOfWeek(this._locale);
        this.header = this._factory.forgeMonth(month, 'MMMM y');
        if (!isFirstDayOfWeek) {
            const offset = (this._adapter.getDay(start) - getLocaleFirstDayOfWeek(this._locale) + 7) % 7;
            index = -1 * offset;
        }
        // TODO
        let isFDOW = false;
        let isNextMonth = false;
        do {
            const d = this._adapter.add(start, index++, ELuDateGranularity.day);
            const day = this._factory.forgeDay(d);
            isNextMonth = this._adapter.compare(d, month, ELuDateGranularity.month) > 0;
            isFDOW = this._adapter.getDay(d) === getLocaleFirstDayOfWeek(this._locale);
            this.items.push(day);
        } while (!isFDOW || !isNextMonth);
        this.applyDailyMods();
    }
    renderMonthlyView(year = this.header.date) {
        this.header = this._factory.forgeYear(year);
        this.items = [...Array(12).keys()].map((i) => {
            const d = this._adapter.forge(this._adapter.getYear(year), i + 1, 1);
            return this._factory.forgeMonth(d);
        });
        this.applyMonthlyMods();
    }
    renderYearlyView(decade = this.header.date) {
        const year = Math.floor(this._adapter.getYear(decade) / 10) * 10;
        const d = this._adapter.forge(year, 1, 1);
        this.header = this._factory.forgeDecade(d);
        this.items = [...Array(10).keys()].map((i) => {
            const y = this._adapter.forge(year + i, 1, 1);
            return this._factory.forgeYear(y);
        });
        this.applyYearlyMods();
    }
    applyDailyMods() {
        const month = this.header.date;
        const today = this._adapter.forgeToday();
        const min = this.min && this._adapter.isValid(this.min) ? this.min : undefined;
        const max = this.max && this._adapter.isValid(this.max) ? this.max : undefined;
        this.items.forEach((item) => {
            const day = item.date;
            if (this._adapter.compare(day, month, ELuDateGranularity.month) < 0) {
                item.mods.push('is-previousMonth');
            }
            if (this._adapter.compare(day, month, ELuDateGranularity.month) > 0) {
                item.mods.push('is-nextMonth');
            }
            if (this._adapter.compare(day, today, ELuDateGranularity.day) === 0) {
                item.mods.push('is-today');
            }
            if (this.value && this._adapter.isValid(this.value) && this._adapter.compare(day, this.value, ELuDateGranularity.day) === 0) {
                item.mods.push('is-active');
            }
            if (min && this._adapter.compare(day, min, ELuDateGranularity.day) < 0) {
                item.isDisabled = true;
            }
            if (max && this._adapter.compare(day, max, ELuDateGranularity.day) > 0) {
                item.isDisabled = true;
            }
        });
    }
    applyMonthlyMods() {
        const today = this._adapter.forgeToday();
        const min = this.min && this._adapter.isValid(this.min) ? this.min : undefined;
        const max = this.max && this._adapter.isValid(this.max) ? this.max : undefined;
        this.items.forEach((item) => {
            const month = item.date;
            if (this._adapter.compare(month, today, ELuDateGranularity.month) === 0) {
                item.mods.push('is-today');
            }
            if (this.value && this._adapter.isValid(this.value) && this._adapter.compare(month, this.value, ELuDateGranularity.month) === 0) {
                item.mods.push('is-active');
            }
            if (min && this._adapter.compare(month, min, ELuDateGranularity.month) < 0) {
                item.isDisabled = true;
            }
            if (max && this._adapter.compare(month, max, ELuDateGranularity.month) > 0) {
                item.isDisabled = true;
            }
        });
    }
    applyYearlyMods() {
        const today = this._adapter.forgeToday();
        const min = this.min && this._adapter.isValid(this.min) ? this.min : undefined;
        const max = this.max && this._adapter.isValid(this.max) ? this.max : undefined;
        this.items.forEach((item) => {
            const year = item.date;
            if (this._adapter.compare(year, today, ELuDateGranularity.year) === 0) {
                item.mods.push('is-today');
            }
            if (this.value && this._adapter.isValid(this.value) && this._adapter.compare(year, this.value, ELuDateGranularity.year) === 0) {
                item.mods.push('is-active');
            }
            if (min && this._adapter.compare(year, min, ELuDateGranularity.year) < 0) {
                item.isDisabled = true;
            }
            if (max && this._adapter.compare(year, max, ELuDateGranularity.year) > 0) {
                item.isDisabled = true;
            }
        });
    }
    select(item) {
        switch (this.viewGranularity) {
            case ELuDateGranularity.year:
                this.selectYear(item);
                break;
            case ELuDateGranularity.month:
                this.selectMonth(item);
                break;
            case ELuDateGranularity.day:
            default:
                this.selectDay(item);
                break;
        }
    }
    selectDay(item) {
        const year = this._adapter.getYear(item.date);
        const month = this._adapter.getMonth(item.date);
        const d = this._adapter.forge(year, month, 1);
        this.header = this._factory.forgeMonth(d);
        this.setValue(item.date);
    }
    selectMonth(item) {
        if (this.granularity === ELuDateGranularity.month) {
            this.setValue(item.date);
        }
        else {
            this.header = item;
            this.viewGranularity = ELuDateGranularity.day;
            this.render();
        }
    }
    selectYear(item) {
        if (this.granularity === ELuDateGranularity.year) {
            this.setValue(item.date);
        }
        else {
            this.header = item;
            this.viewGranularity = ELuDateGranularity.month;
            this.render();
        }
    }
    previous() {
        switch (this.viewGranularity) {
            case ELuDateGranularity.year:
                this.previousDecade();
                break;
            case ELuDateGranularity.month:
                this.previousYear();
                break;
            case ELuDateGranularity.day:
            default:
                this.previousMonth();
                break;
        }
        this.render();
    }
    next() {
        switch (this.viewGranularity) {
            case ELuDateGranularity.year:
                this.nextDecade();
                break;
            case ELuDateGranularity.month:
                this.nextYear();
                break;
            case ELuDateGranularity.day:
            default:
                this.nextMonth();
                break;
        }
        this.render();
    }
    trackBy(_idx, item) {
        return item.id;
    }
    increaseGranularity() {
        if (this.header.granularity !== ELuDateGranularity.decade) {
            this.viewGranularity = this.header.granularity;
            this.render();
        }
    }
    nextMonth() {
        const d = this._adapter.add(this.header.date, 1, ELuDateGranularity.month);
        this.header = this._factory.forgeMonth(d);
    }
    nextYear() {
        const d = this._adapter.add(this.header.date, 1, ELuDateGranularity.year);
        this.header = this._factory.forgeYear(d);
    }
    nextDecade() {
        const d = this._adapter.add(this.header.date, 1, ELuDateGranularity.decade);
        this.header = this._factory.forgeDecade(d);
    }
    previousMonth() {
        const d = this._adapter.add(this.header.date, -1, ELuDateGranularity.month);
        this.header = this._factory.forgeMonth(d);
    }
    previousYear() {
        const d = this._adapter.add(this.header.date, -1, ELuDateGranularity.year);
        this.header = this._factory.forgeYear(d);
    }
    previousDecade() {
        const d = this._adapter.add(this.header.date, -1, ELuDateGranularity.decade);
        this.header = this._factory.forgeDecade(d);
    }
    validate(control) {
        const d = control.value;
        if (!d) {
            return null;
        }
        if (!this._adapter.isValid(d)) {
            return { date: true };
        }
        if (!!this.min && this._adapter.isValid(this.min) && this._adapter.compare(this.min, d, ELuDateGranularity.day) > 0) {
            return { min: true };
        }
        if (!!this.max && this._adapter.isValid(this.max) && this._adapter.compare(this.max, d, ELuDateGranularity.day) < 0) {
            return { max: true };
        }
        return null;
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.3", ngImport: i0, type: LuCalendarInputComponent, deps: [{ token: i0.ChangeDetectorRef }, { token: i0.ElementRef }, { token: i0.Renderer2 }, { token: LOCALE_ID }, { token: i1.LuCalendarItemFactory }, { token: i2.ALuDateAdapter }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.3", type: LuCalendarInputComponent, isStandalone: true, selector: "lu-calendar", inputs: { min: "min", max: "max", granularity: "granularity", startOn: "startOn" }, providers: [
            {
                provide: NG_VALUE_ACCESSOR,
                useExisting: forwardRef(() => LuCalendarInputComponent),
                multi: true,
            },
            {
                provide: NG_VALIDATORS,
                useExisting: LuCalendarInputComponent,
                multi: true,
            },
            LuCalendarItemFactory,
        ], usesInheritance: true, ngImport: i0, template: "<section class=\"calendar\">\n\t<header class=\"calendar-header\">\n\t\t<button type=\"button\" class=\"actionIcon mod-S\" (click)=\"previous()\">\n\t\t\t<span aria-hidden=\"true\" class=\"lucca-icon icon-arrowChevronLeft\"></span>\n\t\t\t<span class=\"u-mask\">Previous</span>\n\t\t</button>\n\t\t<button type=\"button\" class=\"calendar-header-date\" (click)=\"increaseGranularity()\">{{ header.label }}</button>\n\t\t<button type=\"button\" class=\"actionIcon mod-S\" (click)=\"next()\">\n\t\t\t<span aria-hidden=\"true\" class=\"lucca-icon icon-arrowChevronRight\"></span>\n\t\t\t<span class=\"u-mask\">Next</span>\n\t\t</button>\n\t</header>\n\t<section class=\"calendar-labels\" [ngClass]=\"mod\">\n\t\t<div class=\"calendar-labels-item\" *ngFor=\"let label of labels\">{{ label }}</div>\n\t</section>\n\t<section class=\"calendar-grid\" [ngClass]=\"mod\">\n\t\t<button\n\t\t\ttype=\"button\"\n\t\t\t*ngFor=\"let item of items; trackBy: trackBy\"\n\t\t\tclass=\"calendar-grid-item\"\n\t\t\t[ngClass]=\"item.mods\"\n\t\t\t[disabled]=\"item.isDisabled\"\n\t\t\t(click)=\"select(item)\"\n\t\t>\n\t\t\t<div class=\"calendar-grid-item-content\">{{ item.label }}</div>\n\t\t</button>\n\t</section>\n</section>\n", styles: [":root{--components-options-item-padding-vertical: var(--spacings-XS);--components-options-item-padding-horizontal: var(--spacings-XS);--components-options-item-multiple-padding: 2.25rem;--components-options-item-icon-color: var(--palettes-grey-800);--components-options-checkbox-left: .5rem;--components-options-checkbox-size: 1.25rem;--components-options-checkbox-color: var(--palettes-primary-700);--components-options-checkbox-border-radius: 6px;--components-options-checkbox-border-color: var(--palettes-grey-700);--components-options-establishment-multiple-padding: 2rem}.calendar{background-color:var(--colors-white-color);width:var(--components-calendar-width)}:host-context(.mod-block) .calendar{width:auto;max-width:var(--components-calendar-width)}.calendar-header{display:flex;align-items:center;justify-content:space-between}.calendar-header-date{font-weight:600;color:var(--palettes-grey-900);font-size:var(--sizes-L-fontSize);line-height:var(--sizes-L-lineHeight);padding:0;background:transparent;border:none;cursor:pointer}.calendar-header-date:focus-visible{outline:2px solid var(--palettes-primary-700);outline-offset:2px;border-radius:4px}.calendar-labels{display:none}.calendar-labels.mod-dailyView{display:flex;align-items:center;flex-wrap:wrap;text-align:center;height:var(--components-calendar-day-size);font-size:var(--sizes-S-fontSize);color:var(--palettes-primary-700)}.calendar-labels.mod-dailyView .calendar-labels-item{width:var(--components-calendar-day-size)}.calendar-grid{display:flex;text-align:center;align-self:stretch;flex-wrap:wrap;width:var(--components-calendar-width)}.calendar-grid.mod-dailyView .calendar-grid-item{width:var(--components-calendar-day-size)}.calendar-grid.mod-monthlyView .calendar-grid-item-content,.calendar-grid.mod-yearlyView .calendar-grid-item-content{width:5.83rem}.calendar-grid-item{height:var(--components-calendar-day-size);border:none;cursor:pointer;background:transparent;position:relative;padding:0;outline:none;color:var(--palettes-grey-800)}.calendar-grid-item.is-previousMonth,.calendar-grid-item.is-nextMonth{color:var(--palettes-grey-500)}.calendar-grid-item.is-today{color:var(--palettes-primary-700);font-weight:600}.calendar-grid-item.is-today:after{content:\"\";position:absolute;bottom:var(--spacings-XXS);left:var(--spacings-XS);right:var(--spacings-XS);height:2px;background:var(--palettes-primary-700);z-index:1}.calendar-grid-item:hover .calendar-grid-item-content{background:var(--palettes-grey-50)}.calendar-grid-item:active .calendar-grid-item-content{background:var(--palettes-grey-100)}.calendar-grid-item:focus-visible{outline:2px solid var(--palettes-primary-700);outline-offset:2px;border-radius:var(--commons-borderRadius-L);z-index:1}.calendar-grid-item.is-active .calendar-grid-item-content{background:var(--palettes-primary-700);color:var(--palettes-primary-text)}.calendar-grid-item.is-active.is-today:after{background:white!important;transition:background-color var(--commons-animations-durations-fast)}.calendar-grid-item.is-disabled,.calendar-grid-item[disabled]{color:var(--palettes-grey-500);pointer-events:none}.calendar-grid-item.is-disabled:hover .calendar-grid-item-content,.calendar-grid-item[disabled]:hover .calendar-grid-item-content{background-color:#fff}.calendar-grid-item-content{position:relative;height:var(--components-calendar-day-size);width:var(--components-calendar-day-size);line-height:var(--components-calendar-day-size);border-radius:var(--commons-borderRadius-L);transition-duration:var(--commons-animations-durations-fast);transition-property:background-color,color}\n"], dependencies: [{ kind: "ngmodule", type: FormsModule }, { kind: "ngmodule", type: CommonModule }, { kind: "directive", type: i3.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: i3.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
export { LuCalendarInputComponent };
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.3", ngImport: i0, type: LuCalendarInputComponent, decorators: [{
            type: Component,
            args: [{ selector: 'lu-calendar', changeDetection: ChangeDetectionStrategy.OnPush, standalone: true, imports: [FormsModule, CommonModule], providers: [
                        {
                            provide: NG_VALUE_ACCESSOR,
                            useExisting: forwardRef(() => LuCalendarInputComponent),
                            multi: true,
                        },
                        {
                            provide: NG_VALIDATORS,
                            useExisting: LuCalendarInputComponent,
                            multi: true,
                        },
                        LuCalendarItemFactory,
                    ], template: "<section class=\"calendar\">\n\t<header class=\"calendar-header\">\n\t\t<button type=\"button\" class=\"actionIcon mod-S\" (click)=\"previous()\">\n\t\t\t<span aria-hidden=\"true\" class=\"lucca-icon icon-arrowChevronLeft\"></span>\n\t\t\t<span class=\"u-mask\">Previous</span>\n\t\t</button>\n\t\t<button type=\"button\" class=\"calendar-header-date\" (click)=\"increaseGranularity()\">{{ header.label }}</button>\n\t\t<button type=\"button\" class=\"actionIcon mod-S\" (click)=\"next()\">\n\t\t\t<span aria-hidden=\"true\" class=\"lucca-icon icon-arrowChevronRight\"></span>\n\t\t\t<span class=\"u-mask\">Next</span>\n\t\t</button>\n\t</header>\n\t<section class=\"calendar-labels\" [ngClass]=\"mod\">\n\t\t<div class=\"calendar-labels-item\" *ngFor=\"let label of labels\">{{ label }}</div>\n\t</section>\n\t<section class=\"calendar-grid\" [ngClass]=\"mod\">\n\t\t<button\n\t\t\ttype=\"button\"\n\t\t\t*ngFor=\"let item of items; trackBy: trackBy\"\n\t\t\tclass=\"calendar-grid-item\"\n\t\t\t[ngClass]=\"item.mods\"\n\t\t\t[disabled]=\"item.isDisabled\"\n\t\t\t(click)=\"select(item)\"\n\t\t>\n\t\t\t<div class=\"calendar-grid-item-content\">{{ item.label }}</div>\n\t\t</button>\n\t</section>\n</section>\n", styles: [":root{--components-options-item-padding-vertical: var(--spacings-XS);--components-options-item-padding-horizontal: var(--spacings-XS);--components-options-item-multiple-padding: 2.25rem;--components-options-item-icon-color: var(--palettes-grey-800);--components-options-checkbox-left: .5rem;--components-options-checkbox-size: 1.25rem;--components-options-checkbox-color: var(--palettes-primary-700);--components-options-checkbox-border-radius: 6px;--components-options-checkbox-border-color: var(--palettes-grey-700);--components-options-establishment-multiple-padding: 2rem}.calendar{background-color:var(--colors-white-color);width:var(--components-calendar-width)}:host-context(.mod-block) .calendar{width:auto;max-width:var(--components-calendar-width)}.calendar-header{display:flex;align-items:center;justify-content:space-between}.calendar-header-date{font-weight:600;color:var(--palettes-grey-900);font-size:var(--sizes-L-fontSize);line-height:var(--sizes-L-lineHeight);padding:0;background:transparent;border:none;cursor:pointer}.calendar-header-date:focus-visible{outline:2px solid var(--palettes-primary-700);outline-offset:2px;border-radius:4px}.calendar-labels{display:none}.calendar-labels.mod-dailyView{display:flex;align-items:center;flex-wrap:wrap;text-align:center;height:var(--components-calendar-day-size);font-size:var(--sizes-S-fontSize);color:var(--palettes-primary-700)}.calendar-labels.mod-dailyView .calendar-labels-item{width:var(--components-calendar-day-size)}.calendar-grid{display:flex;text-align:center;align-self:stretch;flex-wrap:wrap;width:var(--components-calendar-width)}.calendar-grid.mod-dailyView .calendar-grid-item{width:var(--components-calendar-day-size)}.calendar-grid.mod-monthlyView .calendar-grid-item-content,.calendar-grid.mod-yearlyView .calendar-grid-item-content{width:5.83rem}.calendar-grid-item{height:var(--components-calendar-day-size);border:none;cursor:pointer;background:transparent;position:relative;padding:0;outline:none;color:var(--palettes-grey-800)}.calendar-grid-item.is-previousMonth,.calendar-grid-item.is-nextMonth{color:var(--palettes-grey-500)}.calendar-grid-item.is-today{color:var(--palettes-primary-700);font-weight:600}.calendar-grid-item.is-today:after{content:\"\";position:absolute;bottom:var(--spacings-XXS);left:var(--spacings-XS);right:var(--spacings-XS);height:2px;background:var(--palettes-primary-700);z-index:1}.calendar-grid-item:hover .calendar-grid-item-content{background:var(--palettes-grey-50)}.calendar-grid-item:active .calendar-grid-item-content{background:var(--palettes-grey-100)}.calendar-grid-item:focus-visible{outline:2px solid var(--palettes-primary-700);outline-offset:2px;border-radius:var(--commons-borderRadius-L);z-index:1}.calendar-grid-item.is-active .calendar-grid-item-content{background:var(--palettes-primary-700);color:var(--palettes-primary-text)}.calendar-grid-item.is-active.is-today:after{background:white!important;transition:background-color var(--commons-animations-durations-fast)}.calendar-grid-item.is-disabled,.calendar-grid-item[disabled]{color:var(--palettes-grey-500);pointer-events:none}.calendar-grid-item.is-disabled:hover .calendar-grid-item-content,.calendar-grid-item[disabled]:hover .calendar-grid-item-content{background-color:#fff}.calendar-grid-item-content{position:relative;height:var(--components-calendar-day-size);width:var(--components-calendar-day-size);line-height:var(--components-calendar-day-size);border-radius:var(--commons-borderRadius-L);transition-duration:var(--commons-animations-durations-fast);transition-property:background-color,color}\n"] }]
        }], ctorParameters: function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: i0.Renderer2 }, { type: undefined, decorators: [{
                    type: Inject,
                    args: [LOCALE_ID]
                }] }, { type: i1.LuCalendarItemFactory }, { type: i2.ALuDateAdapter }]; }, propDecorators: { min: [{
                type: Input
            }], max: [{
                type: Input
            }], granularity: [{
                type: Input
            }], startOn: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FsZW5kYXItaW5wdXQuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcGFja2FnZXMvbmcvZGF0ZS9jYWxlbmRhci9jYWxlbmRhci1pbnB1dC5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi9wYWNrYWdlcy9uZy9kYXRlL2NhbGVuZGFyL2NhbGVuZGFyLWlucHV0LmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxZQUFZLEVBQUUsU0FBUyxFQUFFLGlCQUFpQixFQUFFLHVCQUF1QixFQUFFLGdCQUFnQixFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDeEgsT0FBTyxFQUFFLHVCQUF1QixFQUFxQixTQUFTLEVBQWMsVUFBVSxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFxQixNQUFNLGVBQWUsQ0FBQztBQUMzSixPQUFPLEVBQXlDLFdBQVcsRUFBRSxhQUFhLEVBQUUsaUJBQWlCLEVBQStCLE1BQU0sZ0JBQWdCLENBQUM7QUFDbkosT0FBTyxFQUFrQixrQkFBa0IsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQzFFLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUNqRCxPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQzs7Ozs7QUFHaEUsTUFxQmEsd0JBQTRCLFNBQVEsUUFBVztJQVMzRCxJQUFJLEdBQUc7UUFDTixRQUFRLElBQUksQ0FBQyxlQUFlLEVBQUU7WUFDN0IsS0FBSyxrQkFBa0IsQ0FBQyxJQUFJO2dCQUMzQixPQUFPLGdCQUFnQixDQUFDO1lBQ3pCLEtBQUssa0JBQWtCLENBQUMsS0FBSztnQkFDNUIsT0FBTyxpQkFBaUIsQ0FBQztZQUMxQixLQUFLLGtCQUFrQixDQUFDLEdBQUcsQ0FBQztZQUM1QjtnQkFDQyxPQUFPLGVBQWUsQ0FBQztTQUN4QjtJQUNGLENBQUM7SUFJRCxZQUNDLGtCQUFxQyxFQUNyQyxXQUFvQyxFQUNwQyxTQUFvQixFQUNPLE9BQWUsRUFDbEMsUUFBa0MsRUFDbEMsUUFBMkI7UUFFbkMsS0FBSyxDQUFDLGtCQUFrQixFQUFFLFdBQVcsRUFBRSxTQUFTLENBQUMsQ0FBQztRQUp2QixZQUFPLEdBQVAsT0FBTyxDQUFRO1FBQ2xDLGFBQVEsR0FBUixRQUFRLENBQTBCO1FBQ2xDLGFBQVEsR0FBUixRQUFRLENBQW1CO1FBMUIzQixnQkFBVyxHQUF1QixrQkFBa0IsQ0FBQyxHQUFHLENBQUM7UUFDekQsWUFBTyxHQUFNLElBQUksQ0FBQyxRQUFRLENBQUMsVUFBVSxFQUFFLENBQUM7UUFJakQsVUFBSyxHQUF1QixFQUFFLENBQUM7UUFhL0IsYUFBYTtRQUNiLFdBQU0sR0FBYSxFQUFFLENBQUM7SUFVdEIsQ0FBQztJQUNELFFBQVE7UUFDUCxJQUFJLENBQUMsZUFBZSxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUM7UUFDeEMsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO0lBQ3RCLENBQUM7SUFDUSxVQUFVLENBQUMsS0FBUztRQUM1QixNQUFNLElBQUksR0FBRyxLQUFLLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDO1FBQy9GLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDN0MsS0FBSyxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUN6QixDQUFDO0lBQ0QsYUFBYTtRQUNaLElBQUksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxHQUFHLGlCQUFpQixDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsU0FBUyxDQUFDLFVBQVUsRUFBRSxnQkFBZ0IsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO1FBQ3ZHLElBQUksdUJBQXVCLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsRUFBRTtZQUNoRCxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUM7U0FDdEM7SUFDRixDQUFDO0lBQ1MsTUFBTTtRQUNmLFFBQVEsSUFBSSxDQUFDLGVBQWUsRUFBRTtZQUM3QixLQUFLLGtCQUFrQixDQUFDLElBQUk7Z0JBQzNCLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO2dCQUN4QixNQUFNO1lBQ1AsS0FBSyxrQkFBa0IsQ0FBQyxLQUFLO2dCQUM1QixJQUFJLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztnQkFDekIsTUFBTTtZQUNQLEtBQUssa0JBQWtCLENBQUMsR0FBRyxDQUFDO1lBQzVCO2dCQUNDLElBQUksQ0FBQyxlQUFlLEVBQUUsQ0FBQztnQkFDdkIsTUFBTTtTQUNQO0lBQ0YsQ0FBQztJQUVTLGVBQWUsQ0FBQyxRQUFXLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSTtRQUNwRCxJQUFJLENBQUMsS0FBSyxHQUFHLEVBQUUsQ0FBQztRQUNoQixNQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsRUFBRSxJQUFJLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUNsRyxJQUFJLEtBQUssR0FBRyxDQUFDLENBQUM7UUFDZCxNQUFNLGdCQUFnQixHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxLQUFLLHVCQUF1QixDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUMvRixJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDLEtBQUssRUFBRSxRQUFRLENBQUMsQ0FBQztRQUN4RCxJQUFJLENBQUMsZ0JBQWdCLEVBQUU7WUFDdEIsTUFBTSxNQUFNLEdBQUcsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyx1QkFBdUIsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQzdGLEtBQUssR0FBRyxDQUFDLENBQUMsR0FBRyxNQUFNLENBQUM7U0FDcEI7UUFDRCxPQUFPO1FBQ1AsSUFBSSxNQUFNLEdBQUcsS0FBSyxDQUFDO1FBQ25CLElBQUksV0FBVyxHQUFHLEtBQUssQ0FBQztRQUN4QixHQUFHO1lBQ0YsTUFBTSxDQUFDLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsS0FBSyxFQUFFLEtBQUssRUFBRSxFQUFFLGtCQUFrQixDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQ3BFLE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3RDLFdBQVcsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDLEVBQUUsS0FBSyxFQUFFLGtCQUFrQixDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUM1RSxNQUFNLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEtBQUssdUJBQXVCLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQzNFLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1NBQ3JCLFFBQVEsQ0FBQyxNQUFNLElBQUksQ0FBQyxXQUFXLEVBQUU7UUFDbEMsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDO0lBQ3ZCLENBQUM7SUFFUyxpQkFBaUIsQ0FBQyxPQUFVLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSTtRQUNyRCxJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzVDLElBQUksQ0FBQyxLQUFLLEdBQUcsQ0FBQyxHQUFHLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFO1lBQzVDLE1BQU0sQ0FBQyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDckUsT0FBTyxJQUFJLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNwQyxDQUFDLENBQUMsQ0FBQztRQUNILElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO0lBQ3pCLENBQUM7SUFFUyxnQkFBZ0IsQ0FBQyxTQUFZLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSTtRQUN0RCxNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQztRQUNqRSxNQUFNLENBQUMsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQzFDLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDM0MsSUFBSSxDQUFDLEtBQUssR0FBRyxDQUFDLEdBQUcsS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUU7WUFDNUMsTUFBTSxDQUFDLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsSUFBSSxHQUFHLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDOUMsT0FBTyxJQUFJLENBQUMsUUFBUSxD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QUM7SUFDYixDQUFDOzhHQW5UVyx3QkFBd0Isc0dBMkIzQixTQUFTO2tHQTNCTix3QkFBd0IsOElBZHpCO1lBQ1Y7Z0JBQ0MsT0FBTyxFQUFFLGlCQUFpQjtnQkFDMUIsV0FBVyxFQUFFLFVBQVUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyx3QkFBd0IsQ0FBQztnQkFDdkQsS0FBSyxFQUFFLElBQUk7YUFDWDtZQUNEO2dCQUNDLE9BQU8sRUFBRSxhQUFhO2dCQUN0QixXQUFXLEVBQUUsd0JBQXdCO2dCQUNyQyxLQUFLLEVBQUUsSUFBSTthQUNYO1lBQ0QscUJBQXFCO1NBQ3JCLGlEQzNCRiw2ckNBNEJBLHNrSERkVyxXQUFXLDhCQUFFLFlBQVk7O1NBZXZCLHdCQUF3QjsyRkFBeEIsd0JBQXdCO2tCQXJCcEMsU0FBUzsrQkFDQyxhQUFhLG1CQUdOLHVCQUF1QixDQUFDLE1BQU0sY0FDbkMsSUFBSSxXQUNQLENBQUMsV0FBVyxFQUFFLFlBQVksQ0FBQyxhQUN6Qjt3QkFDVjs0QkFDQyxPQUFPLEVBQUUsaUJBQWlCOzRCQUMxQixXQUFXLEVBQUUsVUFBVSxDQUFDLEdBQUcsRUFBRSx5QkFBeUIsQ0FBQzs0QkFDdkQsS0FBSyxFQUFFLElBQUk7eUJBQ1g7d0JBQ0Q7NEJBQ0MsT0FBTyxFQUFFLGFBQWE7NEJBQ3RCLFdBQVcsMEJBQTBCOzRCQUNyQyxLQUFLLEVBQUUsSUFBSTt5QkFDWDt3QkFDRCxxQkFBcUI7cUJBQ3JCOzswQkE2QkMsTUFBTTsyQkFBQyxTQUFTOzZHQTFCVCxHQUFHO3NCQUFYLEtBQUs7Z0JBQ0csR0FBRztzQkFBWCxLQUFLO2dCQUNHLFdBQVc7c0JBQW5CLEtBQUs7Z0JBQ0csT0FBTztzQkFBZixLQUFLIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tbW9uTW9kdWxlLCBGb3JtU3R5bGUsIGdldExvY2FsZURheU5hbWVzLCBnZXRMb2NhbGVGaXJzdERheU9mV2VlaywgVHJhbnNsYXRpb25XaWR0aCB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQgeyBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSwgQ2hhbmdlRGV0ZWN0b3JSZWYsIENvbXBvbmVudCwgRWxlbWVudFJlZiwgZm9yd2FyZFJlZiwgSW5qZWN0LCBJbnB1dCwgTE9DQUxFX0lELCBPbkluaXQsIFJlbmRlcmVyMiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQWJzdHJhY3RDb250cm9sLCBDb250cm9sVmFsdWVBY2Nlc3NvciwgRm9ybXNNb2R1bGUsIE5HX1ZBTElEQVRPUlMsIE5HX1ZBTFVFX0FDQ0VTU09SLCBWYWxpZGF0aW9uRXJyb3JzLCBWYWxpZGF0b3IgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQgeyBBTHVEYXRlQWRhcHRlciwgRUx1RGF0ZUdyYW51bGFyaXR5IH0gZnJvbSAnQGx1Y2NhLWZyb250L25nL2NvcmUnO1xuaW1wb3J0IHsgQUx1SW5wdXQgfSBmcm9tICdAbHVjY2EtZnJvbnQvbmcvaW5wdXQnO1xuaW1wb3J0IHsgTHVDYWxlbmRhckl0ZW1GYWN0b3J5IH0gZnJvbSAnLi9jYWxlbmRhci1pdGVtLmZhY3RvcnknO1xuaW1wb3J0IHsgSUNhbGVuZGFySXRlbSB9IGZyb20gJy4vY2FsZW5kYXItaXRlbS5pbnRlcmZhY2UnO1xuXG5AQ29tcG9uZW50KHtcblx0c2VsZWN0b3I6ICdsdS1jYWxlbmRhcicsXG5cdHRlbXBsYXRlVXJsOiAnLi9jYWxlbmRhci1pbnB1dC5jb21wb25lbnQuaHRtbCcsXG5cdHN0eWxlVXJsczogWycuL2NhbGVuZGFyLWlucHV0LmNvbXBvbmVudC5zY3NzJ10sXG5cdGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxuXHRzdGFuZGFsb25lOiB0cnVlLFxuXHRpbXBvcnRzOiBbRm9ybXNNb2R1bGUsIENvbW1vbk1vZHVsZV0sXG5cdHByb3ZpZGVyczogW1xuXHRcdHtcblx0XHRcdHByb3ZpZGU6IE5HX1ZBTFVFX0FDQ0VTU09SLFxuXHRcdFx0dXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gTHVDYWxlbmRhcklucHV0Q29tcG9uZW50KSxcblx0XHRcdG11bHRpOiB0cnVlLFxuXHRcdH0sXG5cdFx0e1xuXHRcdFx0cHJvdmlkZTogTkdfVkFMSURBVE9SUyxcblx0XHRcdHVzZUV4aXN0aW5nOiBMdUNhbGVuZGFySW5wdXRDb21wb25lbnQsXG5cdFx0XHRtdWx0aTogdHJ1ZSxcblx0XHR9LFxuXHRcdEx1Q2FsZW5kYXJJdGVtRmFjdG9yeSxcblx0XSxcbn0pXG5leHBvcnQgY2xhc3MgTHVDYWxlbmRhcklucHV0Q29tcG9uZW50PEQ+IGV4dGVuZHMgQUx1SW5wdXQ8RD4gaW1wbGVtZW50cyBDb250cm9sVmFsdWVBY2Nlc3NvciwgT25Jbml0LCBWYWxpZGF0b3Ige1xuXHRASW5wdXQoKSBtaW4/OiBEO1xuXHRASW5wdXQoKSBtYXg/OiBEO1xuXHRASW5wdXQoKSBncmFudWxhcml0eTogRUx1RGF0ZUdyYW51bGFyaXR5ID0gRUx1RGF0ZUdyYW51bGFyaXR5LmRheTtcblx0QElucHV0KCkgc3RhcnRPbjogRCA9IHRoaXMuX2FkYXB0ZXIuZm9yZ2VUb2RheSgpO1xuXG5cdHZpZXdHcmFudWxhcml0eTogRUx1RGF0ZUdyYW51bGFyaXR5O1xuXHRoZWFkZXI6IElDYWxlbmRhckl0ZW08RD47XG5cdGl0ZW1zOiBJQ2FsZW5kYXJJdGVtPEQ+W10gPSBbXTtcblx0Z2V0IG1vZCgpIHtcblx0XHRzd2l0Y2ggKHRoaXMudmlld0dyYW51bGFyaXR5KSB7XG5cdFx0XHRjYXNlIEVMdURhdGVHcmFudWxhcml0eS55ZWFyOlxuXHRcdFx0XHRyZXR1cm4gJ21vZC15ZWFybHlWaWV3Jztcblx0XHRcdGNhc2UgRUx1RGF0ZUdyYW51bGFyaXR5Lm1vbnRoOlxuXHRcdFx0XHRyZXR1cm4gJ21vZC1tb250aGx5Vmlldyc7XG5cdFx0XHRjYXNlIEVMdURhdGVHcmFudWxhcml0eS5kYXk6XG5cdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRyZXR1cm4gJ21vZC1kYWlseVZpZXcnO1xuXHRcdH1cblx0fVxuXG5cdC8vIGRhaWx5IHZpZXdcblx0bGFiZWxzOiBzdHJpbmdbXSA9IFtdO1xuXHRjb25zdHJ1Y3Rvcihcblx0XHRfY2hhbmdlRGV0ZWN0b3JSZWY6IENoYW5nZURldGVjdG9yUmVmLFxuXHRcdF9lbGVtZW50UmVmOiBFbGVtZW50UmVmPEhUTUxFbGVtZW50Pixcblx0XHRfcmVuZGVyZXI6IFJlbmRlcmVyMixcblx0XHRASW5qZWN0KExPQ0FMRV9JRCkgcHJpdmF0ZSBfbG9jYWxlOiBzdHJpbmcsXG5cdFx0cHJpdmF0ZSBfZmFjdG9yeTogTHVDYWxlbmRhckl0ZW1GYWN0b3J5PEQ+LFxuXHRcdHByaXZhdGUgX2FkYXB0ZXI6IEFMdURhdGVBZGFwdGVyPEQ+LFxuXHQpIHtcblx0XHRzdXBlcihfY2hhbmdlRGV0ZWN0b3JSZWYsIF9lbGVtZW50UmVmLCBfcmVuZGVyZXIpO1xuXHR9XG5cdG5nT25Jbml0KCkge1xuXHRcdHRoaXMudmlld0dyYW51bGFyaXR5ID0gdGhpcy5ncmFudWxhcml0eTtcblx0XHR0aGlzLmluaXREYXlMYWJlbHMoKTtcblx0fVxuXHRvdmVycmlkZSB3cml0ZVZhbHVlKHZhbHVlPzogRCkge1xuXHRcdGNvbnN0IGRhdGUgPSB2YWx1ZSAmJiB0aGlzLl9hZGFwdGVyLmlzVmFsaWQodmFsdWUpID8gdGhpcy5fYWRhcHRlci5jbG9uZSh2YWx1ZSkgOiB0aGlzLnN0YXJ0T247XG5cdFx0dGhpcy5oZWFkZXIgPSB0aGlzLl9mYWN0b3J5LmZvcmdlTW9udGgoZGF0ZSk7XG5cdFx0c3VwZXIud3JpdGVWYWx1ZSh2YWx1ZSk7XG5cdH1cblx0aW5pdERheUxhYmVscygpIHtcblx0XHR0aGlzLmxhYmVscyA9IFsuLi5nZXRMb2NhbGVEYXlOYW1lcyh0aGlzLl9sb2NhbGUsIEZvcm1TdHlsZS5TdGFuZGFsb25lLCBUcmFuc2xhdGlvbldpZHRoLkFiYnJldmlhdGVkKV07XG5cdFx0aWYgKGdldExvY2FsZUZpcnN0RGF5T2ZXZWVrKHRoaXMuX2xvY2FsZSkgPT09IDEpIHtcblx0XHRcdHRoaXMubGFiZWxzLnB1c2godGhpcy5sYWJlbHMuc2hpZnQoKSk7XG5cdFx0fVxuXHR9XG5cdHByb3RlY3RlZCByZW5kZXIoKSB7XG5cdFx0c3dpdGNoICh0aGlzLnZpZXdHcmFudWxhcml0eSkge1xuXHRcdFx0Y2FzZSBFTHVEYXRlR3JhbnVsYXJpdHkueWVhcjpcblx0XHRcdFx0dGhpcy5yZW5kZXJZZWFybHlWaWV3KCk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSBFTHVEYXRlR3JhbnVsYXJpdHkubW9udGg6XG5cdFx0XHRcdHRoaXMucmVuZGVyTW9udGhseVZpZXcoKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIEVMdURhdGVHcmFudWxhcml0eS5kYXk6XG5cdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHR0aGlzLnJlbmRlckRhaWx5VmlldygpO1xuXHRcdFx0XHRicmVhaztcblx0XHR9XG5cdH1cblxuXHRwcm90ZWN0ZWQgcmVuZGVyRGFpbHlWaWV3KG1vbnRoOiBEID0gdGhpcy5oZWFkZXIuZGF0ZSkge1xuXHRcdHRoaXMuaXRlbXMgPSBbXTtcblx0XHRjb25zdCBzdGFydCA9IHRoaXMuX2FkYXB0ZXIuZm9yZ2UodGhpcy5fYWRhcHRlci5nZXRZZWFyKG1vbnRoKSwgdGhpcy5fYWRhcHRlci5nZXRNb250aChtb250aCksIDEpO1xuXHRcdGxldCBpbmRleCA9IDA7XG5cdFx0Y29uc3QgaXNGaXJzdERheU9mV2VlayA9IHRoaXMuX2FkYXB0ZXIuZ2V0RGF5KHN0YXJ0KSA9PT0gZ2V0TG9jYWxlRmlyc3REYXlPZldlZWsodGhpcy5fbG9jYWxlKTtcblx0XHR0aGlzLmhlYWRlciA9IHRoaXMuX2ZhY3RvcnkuZm9yZ2VNb250aChtb250aCwgJ01NTU0geScpO1xuXHRcdGlmICghaXNGaXJzdERheU9mV2Vlaykge1xuXHRcdFx0Y29uc3Qgb2Zmc2V0ID0gKHRoaXMuX2FkYXB0ZXIuZ2V0RGF5KHN0YXJ0KSAtIGdldExvY2FsZUZpcnN0RGF5T2ZXZWVrKHRoaXMuX2xvY2FsZSkgKyA3KSAlIDc7XG5cdFx0XHRpbmRleCA9IC0xICogb2Zmc2V0O1xuXHRcdH1cblx0XHQvLyBUT0RPXG5cdFx0bGV0IGlzRkRPVyA9IGZhbHNlO1xuXHRcdGxldCBpc05leHRNb250aCA9IGZhbHNlO1xuXHRcdGRvIHtcblx0XHRcdGNvbnN0IGQgPSB0aGlzLl9hZGFwdGVyLmFkZChzdGFydCwgaW5kZXgrKywgRUx1RGF0ZUdyYW51bGFyaXR5LmRheSk7XG5cdFx0XHRjb25zdCBkYXkgPSB0aGlzLl9mYWN0b3J5LmZvcmdlRGF5KGQpO1xuXHRcdFx0aXNOZXh0TW9udGggPSB0aGlzLl9hZGFwdGVyLmNvbXBhcmUoZCwgbW9udGgsIEVMdURhdGVHcmFudWxhcml0eS5tb250aCkgPiAwO1xuXHRcdFx0aXNGRE9XID0gdGhpcy5fYWRhcHRlci5nZXREYXkoZCkgPT09IGdldExvY2FsZUZpcnN0RGF5T2ZXZWVrKHRoaXMuX2xvY2FsZSk7XG5cdFx0XHR0aGlzLml0ZW1zLnB1c2goZGF5KTtcblx0XHR9IHdoaWxlICghaXNGRE9XIHx8ICFpc05leHRNb250aCk7XG5cdFx0dGhpcy5hcHBseURhaWx5TW9kcygpO1xuXHR9XG5cblx0cHJvdGVjdGVkIHJlbmRlck1vbnRobHlWaWV3KHllYXI6IEQgPSB0aGlzLmhlYWRlci5kYXRlKSB7XG5cdFx0dGhpcy5oZWFkZXIgPSB0aGlzLl9mYWN0b3J5LmZvcmdlWWVhcih5ZWFyKTtcblx0XHR0aGlzLml0ZW1zID0gWy4uLkFycmF5KDEyKS5rZXlzKCldLm1hcCgoaSkgPT4ge1xuXHRcdFx0Y29uc3QgZCA9IHRoaXMuX2FkYXB0ZXIuZm9yZ2UodGhpcy5fYWRhcHRlci5nZXRZZWFyKHllYXIpLCBpICsgMSwgMSk7XG5cdFx0XHRyZXR1cm4gdGhpcy5fZmFjdG9yeS5mb3JnZU1vbnRoKGQpO1xuXHRcdH0pO1xuXHRcdHRoaXMuYXBwbHlNb250aGx5TW9kcygpO1xuXHR9XG5cblx0cHJvdGVjdGVkIHJlbmRlclllYXJseVZpZXcoZGVjYWRlOiBEID0gdGhpcy5oZWFkZXIuZGF0ZSkge1xuXHRcdGNvbnN0IHllYXIgPSBNYXRoLmZsb29yKHRoaXMuX2FkYXB0ZXIuZ2V0WWVhcihkZWNhZGUpIC8gMTApICogMTA7XG5cdFx0Y29uc3QgZCA9IHRoaXMuX2FkYXB0ZXIuZm9yZ2UoeWVhciwgMSwgMSk7XG5cdFx0dGhpcy5oZWFkZXIgPSB0aGlzLl9mYWN0b3J5LmZvcmdlRGVjYWRlKGQpO1xuXHRcdHRoaXMuaXRlbXMgPSBbLi4uQXJyYXkoMTApLmtleXMoKV0ubWFwKChpKSA9PiB7XG5cdFx0XHRjb25zdCB5ID0gdGhpcy5fYWRhcHRlci5mb3JnZSh5ZWFyICsgaSwgMSwgMSk7XG5cdFx0XHRyZXR1cm4gdGhpcy5fZmFjdG9yeS5mb3JnZVllYXIoeSk7XG5cdFx0fSk7XG5cdFx0dGhpcy5hcHBseVllYXJseU1vZHMoKTtcblx0fVxuXG5cdHByb3RlY3RlZCBhcHBseURhaWx5TW9kcygpIHtcblx0XHRjb25zdCBtb250aCA9IHRoaXMuaGVhZGVyLmRhdGU7XG5cdFx0Y29uc3QgdG9kYXkgPSB0aGlzLl9hZGFwdGVyLmZvcmdlVG9kYXkoKTtcblx0XHRjb25zdCBtaW4gPSB0aGlzLm1pbiAmJiB0aGlzLl9hZGFwdGVyLmlzVmFsaWQodGhpcy5taW4pID8gdGhpcy5taW4gOiB1bmRlZmluZWQ7XG5cdFx0Y29uc3QgbWF4ID0gdGhpcy5tYXggJiYgdGhpcy5fYWRhcHRlci5pc1ZhbGlkKHRoaXMubWF4KSA/IHRoaXMubWF4IDogdW5kZWZpbmVkO1xuXHRcdHRoaXMuaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuXHRcdFx0Y29uc3QgZGF5ID0gaXRlbS5kYXRlO1xuXHRcdFx0aWYgKHRoaXMuX2FkYXB0ZXIuY29tcGFyZShkYXksIG1vbnRoLCBFTHVEYXRlR3JhbnVsYXJpdHkubW9udGgpIDwgMCkge1xuXHRcdFx0XHRpdGVtLm1vZHMucHVzaCgnaXMtcHJldmlvdXNNb250aCcpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKHRoaXMuX2FkYXB0ZXIuY29tcGFyZShkYXksIG1vbnRoLCBFTHVEYXRlR3JhbnVsYXJpdHkubW9udGgpID4gMCkge1xuXHRcdFx0XHRpdGVtLm1vZHMucHVzaCgnaXMtbmV4dE1vbnRoJyk7XG5cdFx0XHR9XG5cdFx0XHRpZiAodGhpcy5fYWRhcHRlci5jb21wYXJlKGRheSwgdG9kYXksIEVMdURhdGVHcmFudWxhcml0eS5kYXkpID09PSAwKSB7XG5cdFx0XHRcdGl0ZW0ubW9kcy5wdXNoKCdpcy10b2RheScpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKHRoaXMudmFsdWUgJiYgdGhpcy5fYWRhcHRlci5pc1ZhbGlkKHRoaXMudmFsdWUpICYmIHRoaXMuX2FkYXB0ZXIuY29tcGFyZShkYXksIHRoaXMudmFsdWUsIEVMdURhdGVHcmFudWxhcml0eS5kYXkpID09PSAwKSB7XG5cdFx0XHRcdGl0ZW0ubW9kcy5wdXNoKCdpcy1hY3RpdmUnKTtcblx0XHRcdH1cblx0XHRcdGlmIChtaW4gJiYgdGhpcy5fYWRhcHRlci5jb21wYXJlKGRheSwgbWluLCBFTHVEYXRlR3JhbnVsYXJpdHkuZGF5KSA8IDApIHtcblx0XHRcdFx0aXRlbS5pc0Rpc2FibGVkID0gdHJ1ZTtcblx0XHRcdH1cblx0XHRcdGlmIChtYXggJiYgdGhpcy5fYWRhcHRlci5jb21wYXJlKGRheSwgbWF4LCBFTHVEYXRlR3JhbnVsYXJpdHkuZGF5KSA+IDApIHtcblx0XHRcdFx0aXRlbS5pc0Rpc2FibGVkID0gdHJ1ZTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdHByb3RlY3RlZCBhcHBseU1vbnRobHlNb2RzKCkge1xuXHRcdGNvbnN0IHRvZGF5ID0gdGhpcy5fYWRhcHRlci5mb3JnZVRvZGF5KCk7XG5cdFx0Y29uc3QgbWluID0gdGhpcy5taW4gJiYgdGhpcy5fYWRhcHRlci5pc1ZhbGlkKHRoaXMubWluKSA/IHRoaXMubWluIDogdW5kZWZpbmVkO1xuXHRcdGNvbnN0IG1heCA9IHRoaXMubWF4ICYmIHRoaXMuX2FkYXB0ZXIuaXNWYWxpZCh0aGlzLm1heCkgPyB0aGlzLm1heCA6IHVuZGVmaW5lZDtcblx0XHR0aGlzLml0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcblx0XHRcdGNvbnN0IG1vbnRoID0gaXRlbS5kYXRlO1xuXHRcdFx0aWYgKHRoaXMuX2FkYXB0ZXIuY29tcGFyZShtb250aCwgdG9kYXksIEVMdURhdGVHcmFudWxhcml0eS5tb250aCkgPT09IDApIHtcblx0XHRcdFx0aXRlbS5tb2RzLnB1c2goJ2lzLXRvZGF5Jyk7XG5cdFx0XHR9XG5cdFx0XHRpZiAodGhpcy52YWx1ZSAmJiB0aGlzLl9hZGFwdGVyLmlzVmFsaWQodGhpcy52YWx1ZSkgJiYgdGhpcy5fYWRhcHRlci5jb21wYXJlKG1vbnRoLCB0aGlzLnZhbHVlLCBFTHVEYXRlR3JhbnVsYXJpdHkubW9udGgpID09PSAwKSB7XG5cdFx0XHRcdGl0ZW0ubW9kcy5wdXNoKCdpcy1hY3RpdmUnKTtcblx0XHRcdH1cblx0XHRcdGlmIChtaW4gJiYgdGhpcy5fYWRhcHRlci5jb21wYXJlKG1vbnRoLCBtaW4sIEVMdURhdGVHcmFudWxhcml0eS5tb250aCkgPCAwKSB7XG5cdFx0XHRcdGl0ZW0uaXNEaXNhYmxlZCA9IHRydWU7XG5cdFx0XHR9XG5cdFx0XHRpZiAobWF4ICYmIHRoaXMuX2FkYXB0ZXIuY29tcGFyZShtb250aCwgbWF4LCBFTHVEYXRlR3JhbnVsYXJpdHkubW9udGgpID4gMCkge1xuXHRcdFx0XHRpdGVtLmlzRGlzYWJsZWQgPSB0cnVlO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0cHJvdGVjdGVkIGFwcGx5WWVhcmx5TW9kcygpIHtcblx0XHRjb25zdCB0b2RheSA9IHRoaXMuX2FkYXB0ZXIuZm9yZ2VUb2RheSgpO1xuXHRcdGNvbnN0IG1pbiA9IHRoaXMubWluICYmIHRoaXMuX2FkYXB0ZXIuaXNWYWxpZCh0aGlzLm1pbikgPyB0aGlzLm1pbiA6IHVuZGVmaW5lZDtcblx0XHRjb25zdCBtYXggPSB0aGlzLm1heCAmJiB0aGlzLl9hZGFwdGVyLmlzVmFsaWQodGhpcy5tYXgpID8gdGhpcy5tYXggOiB1bmRlZmluZWQ7XG5cdFx0dGhpcy5pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG5cdFx0XHRjb25zdCB5ZWFyID0gaXRlbS5kYXRlO1xuXHRcdFx0aWYgKHRoaXMuX2FkYXB0ZXIuY29tcGFyZSh5ZWFyLCB0b2RheSwgRUx1RGF0ZUdyYW51bGFyaXR5LnllYXIpID09PSAwKSB7XG5cdFx0XHRcdGl0ZW0ubW9kcy5wdXNoKCdpcy10b2RheScpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKHRoaXMudmFsdWUgJiYgdGhpcy5fYWRhcHRlci5pc1ZhbGlkKHRoaXMudmFsdWUpICYmIHRoaXMuX2FkYXB0ZXIuY29tcGFyZSh5ZWFyLCB0aGlzLnZhbHVlLCBFTHVEYXRlR3JhbnVsYXJpdHkueWVhcikgPT09IDApIHtcblx0XHRcdFx0aXRlbS5tb2RzLnB1c2goJ2lzLWFjdGl2ZScpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKG1pbiAmJiB0aGlzLl9hZGFwdGVyLmNvbXBhcmUoeWVhciwgbWluLCBFTHVEYXRlR3JhbnVsYXJpdHkueWVhcikgPCAwKSB7XG5cdFx0XHRcdGl0ZW0uaXNEaXNhYmxlZCA9IHRydWU7XG5cdFx0XHR9XG5cdFx0XHRpZiAobWF4ICYmIHRoaXMuX2FkYXB0ZXIuY29tcGFyZSh5ZWFyLCBtYXgsIEVMdURhdGVHcmFudWxhcml0eS55ZWFyKSA+IDApIHtcblx0XHRcdFx0aXRlbS5pc0Rpc2FibGVkID0gdHJ1ZTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdHNlbGVjdChpdGVtOiBJQ2FsZW5kYXJJdGVtPEQ+KSB7XG5cdFx0c3dpdGNoICh0aGlzLnZpZXdHcmFudWxhcml0eSkge1xuXHRcdFx0Y2FzZSBFTHVEYXRlR3JhbnVsYXJpdHkueWVhcjpcblx0XHRcdFx0dGhpcy5zZWxlY3RZZWFyKGl0ZW0pO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgRUx1RGF0ZUdyYW51bGFyaXR5Lm1vbnRoOlxuXHRcdFx0XHR0aGlzLnNlbGVjdE1vbnRoKGl0ZW0pO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgRUx1RGF0ZUdyYW51bGFyaXR5LmRheTpcblx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdHRoaXMuc2VsZWN0RGF5KGl0ZW0pO1xuXHRcdFx0XHRicmVhaztcblx0XHR9XG5cdH1cblxuXHRwcm90ZWN0ZWQgc2VsZWN0RGF5KGl0ZW06IElDYWxlbmRhckl0ZW08RD4pIHtcblx0XHRjb25zdCB5ZWFyID0gdGhpcy5fYWRhcHRlci5nZXRZZWFyKGl0ZW0uZGF0ZSk7XG5cdFx0Y29uc3QgbW9udGggPSB0aGlzLl9hZGFwdGVyLmdldE1vbnRoKGl0ZW0uZGF0ZSk7XG5cdFx0Y29uc3QgZCA9IHRoaXMuX2FkYXB0ZXIuZm9yZ2UoeWVhciwgbW9udGgsIDEpO1xuXHRcdHRoaXMuaGVhZGVyID0gdGhpcy5fZmFjdG9yeS5mb3JnZU1vbnRoKGQpO1xuXHRcdHRoaXMuc2V0VmFsdWUoaXRlbS5kYXRlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBzZWxlY3RNb250aChpdGVtOiBJQ2FsZW5kYXJJdGVtPEQ+KSB7XG5cdFx0aWYgKHRoaXMuZ3JhbnVsYXJpdHkgPT09IEVMdURhdGVHcmFudWxhcml0eS5tb250aCkge1xuXHRcdFx0dGhpcy5zZXRWYWx1ZShpdGVtLmRhdGUpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmhlYWRlciA9IGl0ZW07XG5cdFx0XHR0aGlzLnZpZXdHcmFudWxhcml0eSA9IEVMdURhdGVHcmFudWxhcml0eS5kYXk7XG5cdFx0XHR0aGlzLnJlbmRlcigpO1xuXHRcdH1cblx0fVxuXG5cdHByb3RlY3RlZCBzZWxlY3RZZWFyKGl0ZW06IElDYWxlbmRhckl0ZW08RD4pIHtcblx0XHRpZiAodGhpcy5ncmFudWxhcml0eSA9PT0gRUx1RGF0ZUdyYW51bGFyaXR5LnllYXIpIHtcblx0XHRcdHRoaXMuc2V0VmFsdWUoaXRlbS5kYXRlKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5oZWFkZXIgPSBpdGVtO1xuXHRcdFx0dGhpcy52aWV3R3JhbnVsYXJpdHkgPSBFTHVEYXRlR3JhbnVsYXJpdHkubW9udGg7XG5cdFx0XHR0aGlzLnJlbmRlcigpO1xuXHRcdH1cblx0fVxuXG5cdHByZXZpb3VzKCkge1xuXHRcdHN3aXRjaCAodGhpcy52aWV3R3JhbnVsYXJpdHkpIHtcblx0XHRcdGNhc2UgRUx1RGF0ZUdyYW51bGFyaXR5LnllYXI6XG5cdFx0XHRcdHRoaXMucHJldmlvdXNEZWNhZGUoKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIEVMdURhdGVHcmFudWxhcml0eS5tb250aDpcblx0XHRcdFx0dGhpcy5wcmV2aW91c1llYXIoKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIEVMdURhdGVHcmFudWxhcml0eS5kYXk6XG5cdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHR0aGlzLnByZXZpb3VzTW9udGgoKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0fVxuXHRcdHRoaXMucmVuZGVyKCk7XG5cdH1cblxuXHRuZXh0KCkge1xuXHRcdHN3aXRjaCAodGhpcy52aWV3R3JhbnVsYXJpdHkpIHtcblx0XHRcdGNhc2UgRUx1RGF0ZUdyYW51bGFyaXR5LnllYXI6XG5cdFx0XHRcdHRoaXMubmV4dERlY2FkZSgpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgRUx1RGF0ZUdyYW51bGFyaXR5Lm1vbnRoOlxuXHRcdFx0XHR0aGlzLm5leHRZZWFyKCk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSBFTHVEYXRlR3JhbnVsYXJpdHkuZGF5OlxuXHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0dGhpcy5uZXh0TW9udGgoKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0fVxuXHRcdHRoaXMucmVuZGVyKCk7XG5cdH1cblxuXHR0cmFja0J5KF9pZHgsIGl0ZW06IElDYWxlbmRhckl0ZW08RD4pIHtcblx0XHRyZXR1cm4gaXRlbS5pZDtcblx0fVxuXG5cdGluY3JlYXNlR3JhbnVsYXJpdHkoKSB7XG5cdFx0aWYgKHRoaXMuaGVhZGVyLmdyYW51bGFyaXR5ICE9PSBFTHVEYXRlR3JhbnVsYXJpdHkuZGVjYWRlKSB7XG5cdFx0XHR0aGlzLnZpZXdHcmFudWxhcml0eSA9IHRoaXMuaGVhZGVyLmdyYW51bGFyaXR5O1xuXHRcdFx0dGhpcy5yZW5kZXIoKTtcblx0XHR9XG5cdH1cblxuXHRwcm90ZWN0ZWQgbmV4dE1vbnRoKCkge1xuXHRcdGNvbnN0IGQgPSB0aGlzLl9hZGFwdGVyLmFkZCh0aGlzLmhlYWRlci5kYXRlLCAxLCBFTHVEYXRlR3JhbnVsYXJpdHkubW9udGgpO1xuXHRcdHRoaXMuaGVhZGVyID0gdGhpcy5fZmFjdG9yeS5mb3JnZU1vbnRoKGQpO1xuXHR9XG5cblx0cHJvdGVjdGVkIG5leHRZZWFyKCkge1xuXHRcdGNvbnN0IGQgPSB0aGlzLl9hZGFwdGVyLmFkZCh0aGlzLmhlYWRlci5kYXRlLCAxLCBFTHVEYXRlR3JhbnVsYXJpdHkueWVhcik7XG5cdFx0dGhpcy5oZWFkZXIgPSB0aGlzLl9mYWN0b3J5LmZvcmdlWWVhcihkKTtcblx0fVxuXG5cdHByb3RlY3RlZCBuZXh0RGVjYWRlKCkge1xuXHRcdGNvbnN0IGQgPSB0aGlzLl9hZGFwdGVyLmFkZCh0aGlzLmhlYWRlci5kYXRlLCAxLCBFTHVEYXRlR3JhbnVsYXJpdHkuZGVjYWRlKTtcblx0XHR0aGlzLmhlYWRlciA9IHRoaXMuX2ZhY3RvcnkuZm9yZ2VEZWNhZGUoZCk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgcHJldmlvdXNNb250aCgpIHtcblx0XHRjb25zdCBkID0gdGhpcy5fYWRhcHRlci5hZGQodGhpcy5oZWFkZXIuZGF0ZSwgLTEsIEVMdURhdGVHcmFudWxhcml0eS5tb250aCk7XG5cdFx0dGhpcy5oZWFkZXIgPSB0aGlzLl9mYWN0b3J5LmZvcmdlTW9udGgoZCk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgcHJldmlvdXNZZWFyKCkge1xuXHRcdGNvbnN0IGQgPSB0aGlzLl9hZGFwdGVyLmFkZCh0aGlzLmhlYWRlci5kYXRlLCAtMSwgRUx1RGF0ZUdyYW51bGFyaXR5LnllYXIpO1xuXHRcdHRoaXMuaGVhZGVyID0gdGhpcy5fZmFjdG9yeS5mb3JnZVllYXIoZCk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgcHJldmlvdXNEZWNhZGUoKSB7XG5cdFx0Y29uc3QgZCA9IHRoaXMuX2FkYXB0ZXIuYWRkKHRoaXMuaGVhZGVyLmRhdGUsIC0xLCBFTHVEYXRlR3JhbnVsYXJpdHkuZGVjYWRlKTtcblx0XHR0aGlzLmhlYWRlciA9IHRoaXMuX2ZhY3RvcnkuZm9yZ2VEZWNhZGUoZCk7XG5cdH1cblxuXHR2YWxpZGF0ZShjb250cm9sOiBBYnN0cmFjdENvbnRyb2wpOiBWYWxpZGF0aW9uRXJyb3JzIHwgbnVsbCB7XG5cdFx0Y29uc3QgZCA9IGNvbnRyb2wudmFsdWUgYXMgRDtcblx0XHRpZiAoIWQpIHtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0XHRpZiAoIXRoaXMuX2FkYXB0ZXIuaXNWYWxpZChkKSkge1xuXHRcdFx0cmV0dXJuIHsgZGF0ZTogdHJ1ZSB9O1xuXHRcdH1cblx0XHRpZiAoISF0aGlzLm1pbiAmJiB0aGlzLl9hZGFwdGVyLmlzVmFsaWQodGhpcy5taW4pICYmIHRoaXMuX2FkYXB0ZXIuY29tcGFyZSh0aGlzLm1pbiwgZCwgRUx1RGF0ZUdyYW51bGFyaXR5LmRheSkgPiAwKSB7XG5cdFx0XHRyZXR1cm4geyBtaW46IHRydWUgfTtcblx0XHR9XG5cdFx0aWYgKCEhdGhpcy5tYXggJiYgdGhpcy5fYWRhcHRlci5pc1ZhbGlkKHRoaXMubWF4KSAmJiB0aGlzLl9hZGFwdGVyLmNvbXBhcmUodGhpcy5tYXgsIGQsIEVMdURhdGVHcmFudWxhcml0eS5kYXkpIDwgMCkge1xuXHRcdFx0cmV0dXJuIHsgbWF4OiB0cnVlIH07XG5cdFx0fVxuXHRcdHJldHVybiBudWxsO1xuXHR9XG59XG4iLCI8c2VjdGlvbiBjbGFzcz1cImNhbGVuZGFyXCI+XG5cdDxoZWFkZXIgY2xhc3M9XCJjYWxlbmRhci1oZWFkZXJcIj5cblx0XHQ8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImFjdGlvbkljb24gbW9kLVNcIiAoY2xpY2spPVwicHJldmlvdXMoKVwiPlxuXHRcdFx0PHNwYW4gYXJpYS1oaWRkZW49XCJ0cnVlXCIgY2xhc3M9XCJsdWNjYS1pY29uIGljb24tYXJyb3dDaGV2cm9uTGVmdFwiPjwvc3Bhbj5cblx0XHRcdDxzcGFuIGNsYXNzPVwidS1tYXNrXCI+UHJldmlvdXM8L3NwYW4+XG5cdFx0PC9idXR0b24+XG5cdFx0PGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJjYWxlbmRhci1oZWFkZXItZGF0ZVwiIChjbGljayk9XCJpbmNyZWFzZUdyYW51bGFyaXR5KClcIj57eyBoZWFkZXIubGFiZWwgfX08L2J1dHRvbj5cblx0XHQ8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImFjdGlvbkljb24gbW9kLVNcIiAoY2xpY2spPVwibmV4dCgpXCI+XG5cdFx0XHQ8c3BhbiBhcmlhLWhpZGRlbj1cInRydWVcIiBjbGFzcz1cImx1Y2NhLWljb24gaWNvbi1hcnJvd0NoZXZyb25SaWdodFwiPjwvc3Bhbj5cblx0XHRcdDxzcGFuIGNsYXNzPVwidS1tYXNrXCI+TmV4dDwvc3Bhbj5cblx0XHQ8L2J1dHRvbj5cblx0PC9oZWFkZXI+XG5cdDxzZWN0aW9uIGNsYXNzPVwiY2FsZW5kYXItbGFiZWxzXCIgW25nQ2xhc3NdPVwibW9kXCI+XG5cdFx0PGRpdiBjbGFzcz1cImNhbGVuZGFyLWxhYmVscy1pdGVtXCIgKm5nRm9yPVwibGV0IGxhYmVsIG9mIGxhYmVsc1wiPnt7IGxhYmVsIH19PC9kaXY+XG5cdDwvc2VjdGlvbj5cblx0PHNlY3Rpb24gY2xhc3M9XCJjYWxlbmRhci1ncmlkXCIgW25nQ2xhc3NdPVwibW9kXCI+XG5cdFx0PGJ1dHRvblxuXHRcdFx0dHlwZT1cImJ1dHRvblwiXG5cdFx0XHQqbmdGb3I9XCJsZXQgaXRlbSBvZiBpdGVtczsgdHJhY2tCeTogdHJhY2tCeVwiXG5cdFx0XHRjbGFzcz1cImNhbGVuZGFyLWdyaWQtaXRlbVwiXG5cdFx0XHRbbmdDbGFzc109XCJpdGVtLm1vZHNcIlxuXHRcdFx0W2Rpc2FibGVkXT1cIml0ZW0uaXNEaXNhYmxlZFwiXG5cdFx0XHQoY2xpY2spPVwic2VsZWN0KGl0ZW0pXCJcblx0XHQ+XG5cdFx0XHQ8ZGl2IGNsYXNzPVwiY2FsZW5kYXItZ3JpZC1pdGVtLWNvbnRlbnRcIj57eyBpdGVtLmxhYmVsIH19PC9kaXY+XG5cdFx0PC9idXR0b24+XG5cdDwvc2VjdGlvbj5cbjwvc2VjdGlvbj5cbiJdfQ==