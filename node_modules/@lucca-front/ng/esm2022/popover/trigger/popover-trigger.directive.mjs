import { Directive, EventEmitter, HostBinding, HostListener, Input, Output } from '@angular/core';
import { LuPopoverTarget } from '../target/index';
import { ALuPopoverTrigger } from './popover-trigger.model';
import * as i0 from "@angular/core";
import * as i1 from "@angular/cdk/overlay";
/**
 * This directive is intended to be used in conjunction with an lu-popover tag.  It is
 * responsible for toggling the display of the provided popover instance.
 */
class LuPopoverTriggerDirective extends ALuPopoverTrigger {
    /** References the popover instance that the trigger is associated with. */
    set inputPanel(p) {
        this.panel = p;
    }
    /** References the popover target instance that the trigger is associated with. */
    set inputTarget(t) {
        this.target = t;
    }
    /** References the popover target instance that the trigger is associated with. */
    set inputTriggerEvent(te) {
        this.triggerEvent = te;
    }
    /** how you want to position the panel relative to the target, allowed values: above, below, before, after */
    set inputPosition(pos) {
        this.target.position = pos;
    }
    /** how the panel will be align with the target, allowed values: top, bottom, left, right */
    set inputAlignment(al) {
        this.target.alignment = al;
    }
    /** when trigger = hover, delay before the popover panel appears */
    set inputEnterDelay(d) {
        this.enterDelay = d;
    }
    /** when trigger = hover, delay before the popover panel disappears */
    set inputLeaveDelay(d) {
        this.leaveDelay = d;
    }
    /** disable popover apparition */
    set inputDisabled(d) {
        this.disabled = d;
    }
    /** set to true if you want the panel to appear on top of the target */
    set inputOverlap(ov) {
        this.target.overlap = ov;
    }
    set inputOffsetX(ox) {
        this.target.offsetX = ox;
    }
    set inputOffsetY(oy) {
        this.target.offsetY = oy;
    }
    /** accessibility attribute - dont override */
    get _attrAriaExpanded() {
        return this._popoverOpen;
    }
    /** accessibility attribute - dont override */
    get _attrId() {
        return this._triggerId;
    }
    /** accessibility attribute - dont override */
    get _attrAriaControls() {
        return this._panelId;
    }
    constructor(_overlay, _elementRef, _viewContainerRef) {
        super(_overlay, _elementRef, _viewContainerRef);
        this._overlay = _overlay;
        this._elementRef = _elementRef;
        this._viewContainerRef = _viewContainerRef;
        /** Event emitted when the associated popover is opened. */
        // eslint-disable-next-line @angular-eslint/no-output-on-prefix
        this.onOpen = new EventEmitter();
        /** Event emitted when the associated popover is closed. */
        // eslint-disable-next-line @angular-eslint/no-output-on-prefix
        this.onClose = new EventEmitter();
        this.target = new LuPopoverTarget();
        this.target.elementRef = this._elementRef;
        this._triggerId = this._elementRef.nativeElement.getAttribute('id') || this._triggerId;
    }
    onClick() {
        super.onClick();
    }
    onMouseEnter() {
        super.onMouseEnter();
    }
    onMouseLeave() {
        super.onMouseLeave();
    }
    onFocus() {
        super.onFocus();
    }
    onBlur() {
        super.onBlur();
    }
    ngAfterViewInit() {
        this._checkPanel();
        this._checkTarget();
    }
    ngOnDestroy() {
        this._cleanUpSubscriptions();
        if (this._popoverOpen) {
            this.closePopover();
        }
        this.destroyPopover();
    }
    _emitOpen() {
        this.onOpen.emit();
    }
    _emitClose() {
        this.onClose.emit();
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.3", ngImport: i0, type: LuPopoverTriggerDirective, deps: [{ token: i1.Overlay }, { token: i0.ElementRef }, { token: i0.ViewContainerRef }], target: i0.ɵɵFactoryTarget.Directive }); }
    static { this.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "14.0.0", version: "16.1.3", type: LuPopoverTriggerDirective, isStandalone: true, selector: "[luPopover]", inputs: { inputPanel: ["luPopover", "inputPanel"], inputTarget: ["luPopoverTarget", "inputTarget"], inputTriggerEvent: ["luPopoverTrigger", "inputTriggerEvent"], inputPosition: ["luPopoverPosition", "inputPosition"], inputAlignment: ["luPopoverAlignment", "inputAlignment"], inputEnterDelay: ["luPopoverEnterDelay", "inputEnterDelay"], inputLeaveDelay: ["luPopoverLeaveDelay", "inputLeaveDelay"], inputDisabled: ["luPopoverDisabled", "inputDisabled"], inputOverlap: ["luPopoverOverlap", "inputOverlap"], inputOffsetX: ["luPopoverOffsetX", "inputOffsetX"], inputOffsetY: ["luPopoverOffsetY", "inputOffsetY"] }, outputs: { onOpen: "luPopoverOnOpen", onClose: "luPopoverOnClose" }, host: { listeners: { "click": "onClick()", "mouseenter": "onMouseEnter()", "mouseleave": "onMouseLeave()", "focus": "onFocus()", "blur": "onBlur()" }, properties: { "attr.aria-expanded": "this._attrAriaExpanded", "attr.id": "this._attrId", "attr.aria-controls": "this._attrAriaControls" } }, exportAs: ["LuPopoverTrigger"], usesInheritance: true, ngImport: i0 }); }
}
export { LuPopoverTriggerDirective };
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.3", ngImport: i0, type: LuPopoverTriggerDirective, decorators: [{
            type: Directive,
            args: [{
                    selector: '[luPopover]',
                    exportAs: 'LuPopoverTrigger',
                    standalone: true,
                }]
        }], ctorParameters: function () { return [{ type: i1.Overlay }, { type: i0.ElementRef }, { type: i0.ViewContainerRef }]; }, propDecorators: { inputPanel: [{
                type: Input,
                args: ['luPopover']
            }], inputTarget: [{
                type: Input,
                args: ['luPopoverTarget']
            }], inputTriggerEvent: [{
                type: Input,
                args: ['luPopoverTrigger']
            }], onOpen: [{
                type: Output,
                args: ['luPopoverOnOpen']
            }], onClose: [{
                type: Output,
                args: ['luPopoverOnClose']
            }], inputPosition: [{
                type: Input,
                args: ['luPopoverPosition']
            }], inputAlignment: [{
                type: Input,
                args: ['luPopoverAlignment']
            }], inputEnterDelay: [{
                type: Input,
                args: ['luPopoverEnterDelay']
            }], inputLeaveDelay: [{
                type: Input,
                args: ['luPopoverLeaveDelay']
            }], inputDisabled: [{
                type: Input,
                args: ['luPopoverDisabled']
            }], inputOverlap: [{
                type: Input,
                args: ['luPopoverOverlap']
            }], inputOffsetX: [{
                type: Input,
                args: ['luPopoverOffsetX']
            }], inputOffsetY: [{
                type: Input,
                args: ['luPopoverOffsetY']
            }], _attrAriaExpanded: [{
                type: HostBinding,
                args: ['attr.aria-expanded']
            }], _attrId: [{
                type: HostBinding,
                args: ['attr.id']
            }], _attrAriaControls: [{
                type: HostBinding,
                args: ['attr.aria-controls']
            }], onClick: [{
                type: HostListener,
                args: ['click']
            }], onMouseEnter: [{
                type: HostListener,
                args: ['mouseenter']
            }], onMouseLeave: [{
                type: HostListener,
                args: ['mouseleave']
            }], onFocus: [{
                type: HostListener,
                args: ['focus']
            }], onBlur: [{
                type: HostListener,
                args: ['blur']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG9wb3Zlci10cmlnZ2VyLmRpcmVjdGl2ZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL25nL3BvcG92ZXIvdHJpZ2dlci9wb3BvdmVyLXRyaWdnZXIuZGlyZWN0aXZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBaUIsU0FBUyxFQUFjLFlBQVksRUFBRSxXQUFXLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBYSxNQUFNLEVBQW9CLE1BQU0sZUFBZSxDQUFDO0FBRTFKLE9BQU8sRUFBMkQsZUFBZSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDM0csT0FBTyxFQUFFLGlCQUFpQixFQUE0QyxNQUFNLHlCQUF5QixDQUFDOzs7QUFFdEc7OztHQUdHO0FBQ0gsTUFLYSx5QkFDWixTQUFRLGlCQUFrQztJQUcxQywyRUFBMkU7SUFDM0UsSUFBd0IsVUFBVSxDQUFDLENBQVM7UUFDM0MsSUFBSSxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUM7SUFDaEIsQ0FBQztJQUVELGtGQUFrRjtJQUNsRixJQUE4QixXQUFXLENBQUMsQ0FBVTtRQUNuRCxJQUFJLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQztJQUNqQixDQUFDO0lBRUQsa0ZBQWtGO0lBQ2xGLElBQStCLGlCQUFpQixDQUFDLEVBQXlCO1FBQ3pFLElBQUksQ0FBQyxZQUFZLEdBQUcsRUFBRSxDQUFDO0lBQ3hCLENBQUM7SUFVRCw2R0FBNkc7SUFDN0csSUFBZ0MsYUFBYSxDQUFDLEdBQXNCO1FBQ25FLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxHQUFHLEdBQUcsQ0FBQztJQUM1QixDQUFDO0lBQ0QsNEZBQTRGO0lBQzVGLElBQWlDLGNBQWMsQ0FBQyxFQUFzQjtRQUNyRSxJQUFJLENBQUMsTUFBTSxDQUFDLFNBQVMsR0FBRyxFQUFFLENBQUM7SUFDNUIsQ0FBQztJQUVELG1FQUFtRTtJQUNuRSxJQUFrQyxlQUFlLENBQUMsQ0FBUztRQUMx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LE1BQU07c0JBRGQsWUFBWTt1QkFBQyxNQUFNIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgT3ZlcmxheSB9IGZyb20gJ0Bhbmd1bGFyL2Nkay9vdmVybGF5JztcbmltcG9ydCB7IEFmdGVyVmlld0luaXQsIERpcmVjdGl2ZSwgRWxlbWVudFJlZiwgRXZlbnRFbWl0dGVyLCBIb3N0QmluZGluZywgSG9zdExpc3RlbmVyLCBJbnB1dCwgT25EZXN0cm95LCBPdXRwdXQsIFZpZXdDb250YWluZXJSZWYgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IElMdVBvcG92ZXJQYW5lbCB9IGZyb20gJy4uL3BhbmVsL2luZGV4JztcbmltcG9ydCB7IElMdVBvcG92ZXJUYXJnZXQsIEx1UG9wb3ZlckFsaWdubWVudCwgTHVQb3BvdmVyUG9zaXRpb24sIEx1UG9wb3ZlclRhcmdldCB9IGZyb20gJy4uL3RhcmdldC9pbmRleCc7XG5pbXBvcnQgeyBBTHVQb3BvdmVyVHJpZ2dlciwgSUx1UG9wb3ZlclRyaWdnZXIsIEx1UG9wb3ZlclRyaWdnZXJFdmVudCB9IGZyb20gJy4vcG9wb3Zlci10cmlnZ2VyLm1vZGVsJztcblxuLyoqXG4gKiBUaGlzIGRpcmVjdGl2ZSBpcyBpbnRlbmRlZCB0byBiZSB1c2VkIGluIGNvbmp1bmN0aW9uIHdpdGggYW4gbHUtcG9wb3ZlciB0YWcuICBJdCBpc1xuICogcmVzcG9uc2libGUgZm9yIHRvZ2dsaW5nIHRoZSBkaXNwbGF5IG9mIHRoZSBwcm92aWRlZCBwb3BvdmVyIGluc3RhbmNlLlxuICovXG5ARGlyZWN0aXZlKHtcblx0c2VsZWN0b3I6ICdbbHVQb3BvdmVyXScsXG5cdGV4cG9ydEFzOiAnTHVQb3BvdmVyVHJpZ2dlcicsXG5cdHN0YW5kYWxvbmU6IHRydWUsXG59KVxuZXhwb3J0IGNsYXNzIEx1UG9wb3ZlclRyaWdnZXJEaXJlY3RpdmU8VFBhbmVsIGV4dGVuZHMgSUx1UG9wb3ZlclBhbmVsID0gSUx1UG9wb3ZlclBhbmVsLCBUVGFyZ2V0IGV4dGVuZHMgSUx1UG9wb3ZlclRhcmdldCA9IElMdVBvcG92ZXJUYXJnZXQ+XG5cdGV4dGVuZHMgQUx1UG9wb3ZlclRyaWdnZXI8VFBhbmVsLCBUVGFyZ2V0PlxuXHRpbXBsZW1lbnRzIElMdVBvcG92ZXJUcmlnZ2VyPFRQYW5lbCwgVFRhcmdldD4sIEFmdGVyVmlld0luaXQsIE9uRGVzdHJveVxue1xuXHQvKiogUmVmZXJlbmNlcyB0aGUgcG9wb3ZlciBpbnN0YW5jZSB0aGF0IHRoZSB0cmlnZ2VyIGlzIGFzc29jaWF0ZWQgd2l0aC4gKi9cblx0QElucHV0KCdsdVBvcG92ZXInKSBzZXQgaW5wdXRQYW5lbChwOiBUUGFuZWwpIHtcblx0XHR0aGlzLnBhbmVsID0gcDtcblx0fVxuXG5cdC8qKiBSZWZlcmVuY2VzIHRoZSBwb3BvdmVyIHRhcmdldCBpbnN0YW5jZSB0aGF0IHRoZSB0cmlnZ2VyIGlzIGFzc29jaWF0ZWQgd2l0aC4gKi9cblx0QElucHV0KCdsdVBvcG92ZXJUYXJnZXQnKSBzZXQgaW5wdXRUYXJnZXQodDogVFRhcmdldCkge1xuXHRcdHRoaXMudGFyZ2V0ID0gdDtcblx0fVxuXG5cdC8qKiBSZWZlcmVuY2VzIHRoZSBwb3BvdmVyIHRhcmdldCBpbnN0YW5jZSB0aGF0IHRoZSB0cmlnZ2VyIGlzIGFzc29jaWF0ZWQgd2l0aC4gKi9cblx0QElucHV0KCdsdVBvcG92ZXJUcmlnZ2VyJykgc2V0IGlucHV0VHJpZ2dlckV2ZW50KHRlOiBMdVBvcG92ZXJUcmlnZ2VyRXZlbnQpIHtcblx0XHR0aGlzLnRyaWdnZXJFdmVudCA9IHRlO1xuXHR9XG5cblx0LyoqIEV2ZW50IGVtaXR0ZWQgd2hlbiB0aGUgYXNzb2NpYXRlZCBwb3BvdmVyIGlzIG9wZW5lZC4gKi9cblx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEBhbmd1bGFyLWVzbGludC9uby1vdXRwdXQtb24tcHJlZml4XG5cdEBPdXRwdXQoJ2x1UG9wb3Zlck9uT3BlbicpIG9uT3BlbiA9IG5ldyBFdmVudEVtaXR0ZXI8dm9pZD4oKTtcblxuXHQvKiogRXZlbnQgZW1pdHRlZCB3aGVuIHRoZSBhc3NvY2lhdGVkIHBvcG92ZXIgaXMgY2xvc2VkLiAqL1xuXHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQGFuZ3VsYXItZXNsaW50L25vLW91dHB1dC1vbi1wcmVmaXhcblx0QE91dHB1dCgnbHVQb3BvdmVyT25DbG9zZScpIG9uQ2xvc2UgPSBuZXcgRXZlbnRFbWl0dGVyPHZvaWQ+KCk7XG5cblx0LyoqIGhvdyB5b3Ugd2FudCB0byBwb3NpdGlvbiB0aGUgcGFuZWwgcmVsYXRpdmUgdG8gdGhlIHRhcmdldCwgYWxsb3dlZCB2YWx1ZXM6IGFib3ZlLCBiZWxvdywgYmVmb3JlLCBhZnRlciAqL1xuXHRASW5wdXQoJ2x1UG9wb3ZlclBvc2l0aW9uJykgc2V0IGlucHV0UG9zaXRpb24ocG9zOiBMdVBvcG92ZXJQb3NpdGlvbikge1xuXHRcdHRoaXMudGFyZ2V0LnBvc2l0aW9uID0gcG9zO1xuXHR9XG5cdC8qKiBob3cgdGhlIHBhbmVsIHdpbGwgYmUgYWxpZ24gd2l0aCB0aGUgdGFyZ2V0LCBhbGxvd2VkIHZhbHVlczogdG9wLCBib3R0b20sIGxlZnQsIHJpZ2h0ICovXG5cdEBJbnB1dCgnbHVQb3BvdmVyQWxpZ25tZW50Jykgc2V0IGlucHV0QWxpZ25tZW50KGFsOiBMdVBvcG92ZXJBbGlnbm1lbnQpIHtcblx0XHR0aGlzLnRhcmdldC5hbGlnbm1lbnQgPSBhbDtcblx0fVxuXG5cdC8qKiB3aGVuIHRyaWdnZXIgPSBob3ZlciwgZGVsYXkgYmVmb3JlIHRoZSBwb3BvdmVyIHBhbmVsIGFwcGVhcnMgKi9cblx0QElucHV0KCdsdVBvcG92ZXJFbnRlckRlbGF5Jykgc2V0IGlucHV0RW50ZXJEZWxheShkOiBudW1iZXIpIHtcblx0XHR0aGlzLmVudGVyRGVsYXkgPSBkO1xuXHR9XG5cdC8qKiB3aGVuIHRyaWdnZXIgPSBob3ZlciwgZGVsYXkgYmVmb3JlIHRoZSBwb3BvdmVyIHBhbmVsIGRpc2FwcGVhcnMgKi9cblx0QElucHV0KCdsdVBvcG92ZXJMZWF2ZURlbGF5Jykgc2V0IGlucHV0TGVhdmVEZWxheShkOiBudW1iZXIpIHtcblx0XHR0aGlzLmxlYXZlRGVsYXkgPSBkO1xuXHR9XG5cblx0LyoqIGRpc2FibGUgcG9wb3ZlciBhcHBhcml0aW9uICovXG5cdEBJbnB1dCgnbHVQb3BvdmVyRGlzYWJsZWQnKSBzZXQgaW5wdXREaXNhYmxlZChkOiBib29sZWFuKSB7XG5cdFx0dGhpcy5kaXNhYmxlZCA9IGQ7XG5cdH1cblxuXHQvKiogc2V0IHRvIHRydWUgaWYgeW91IHdhbnQgdGhlIHBhbmVsIHRvIGFwcGVhciBvbiB0b3Agb2YgdGhlIHRhcmdldCAqL1xuXHRASW5wdXQoJ2x1UG9wb3Zlck92ZXJsYXAnKSBzZXQgaW5wdXRPdmVybGFwKG92OiBib29sZWFuKSB7XG5cdFx0dGhpcy50YXJnZXQub3ZlcmxhcCA9IG92O1xuXHR9XG5cblx0QElucHV0KCdsdVBvcG92ZXJPZmZzZXRYJykgc2V0IGlucHV0T2Zmc2V0WChveDogbnVtYmVyKSB7XG5cdFx0dGhpcy50YXJnZXQub2Zmc2V0WCA9IG94O1xuXHR9XG5cdEBJbnB1dCgnbHVQb3BvdmVyT2Zmc2V0WScpIHNldCBpbnB1dE9mZnNldFkob3k6IG51bWJlcikge1xuXHRcdHRoaXMudGFyZ2V0Lm9mZnNldFkgPSBveTtcblx0fVxuXG5cdC8qKiBhY2Nlc3NpYmlsaXR5IGF0dHJpYnV0ZSAtIGRvbnQgb3ZlcnJpZGUgKi9cblx0QEhvc3RCaW5kaW5nKCdhdHRyLmFyaWEtZXhwYW5kZWQnKSBnZXQgX2F0dHJBcmlhRXhwYW5kZWQoKSB7XG5cdFx0cmV0dXJuIHRoaXMuX3BvcG92ZXJPcGVuO1xuXHR9XG5cdC8qKiBhY2Nlc3NpYmlsaXR5IGF0dHJpYnV0ZSAtIGRvbnQgb3ZlcnJpZGUgKi9cblx0QEhvc3RCaW5kaW5nKCdhdHRyLmlkJykgZ2V0IF9hdHRySWQoKSB7XG5cdFx0cmV0dXJuIHRoaXMuX3RyaWdnZXJJZDtcblx0fVxuXHQvKiogYWNjZXNzaWJpbGl0eSBhdHRyaWJ1dGUgLSBkb250IG92ZXJyaWRlICovXG5cdEBIb3N0QmluZGluZygnYXR0ci5hcmlhLWNvbnRyb2xzJykgZ2V0IF9hdHRyQXJpYUNvbnRyb2xzKCkge1xuXHRcdHJldHVybiB0aGlzLl9wYW5lbElkO1xuXHR9XG5cblx0Y29uc3RydWN0b3IocHJvdGVjdGVkIG92ZXJyaWRlIF9vdmVybGF5OiBPdmVybGF5LCBwcm90ZWN0ZWQgb3ZlcnJpZGUgX2VsZW1lbnRSZWY6IEVsZW1lbnRSZWY8SFRNTEVsZW1lbnQ+LCBwcm90ZWN0ZWQgb3ZlcnJpZGUgX3ZpZXdDb250YWluZXJSZWY6IFZpZXdDb250YWluZXJSZWYpIHtcblx0XHRzdXBlcihfb3ZlcmxheSwgX2VsZW1lbnRSZWYsIF92aWV3Q29udGFpbmVyUmVmKTtcblx0XHR0aGlzLnRhcmdldCA9IG5ldyBMdVBvcG92ZXJUYXJnZXQoKSBhcyBJTHVQb3BvdmVyVGFyZ2V0IGFzIFRUYXJnZXQ7XG5cdFx0dGhpcy50YXJnZXQuZWxlbWVudFJlZiA9IHRoaXMuX2VsZW1lbnRSZWY7XG5cdFx0dGhpcy5fdHJpZ2dlcklkID0gdGhpcy5fZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LmdldEF0dHJpYnV0ZSgnaWQnKSB8fCB0aGlzLl90cmlnZ2VySWQ7XG5cdH1cblxuXHRASG9zdExpc3RlbmVyKCdjbGljaycpXG5cdG92ZXJyaWRlIG9uQ2xpY2soKSB7XG5cdFx0c3VwZXIub25DbGljaygpO1xuXHR9XG5cblx0QEhvc3RMaXN0ZW5lcignbW91c2VlbnRlcicpXG5cdG92ZXJyaWRlIG9uTW91c2VFbnRlcigpIHtcblx0XHRzdXBlci5vbk1vdXNlRW50ZXIoKTtcblx0fVxuXG5cdEBIb3N0TGlzdGVuZXIoJ21vdXNlbGVhdmUnKVxuXHRvdmVycmlkZSBvbk1vdXNlTGVhdmUoKSB7XG5cdFx0c3VwZXIub25Nb3VzZUxlYXZlKCk7XG5cdH1cblx0QEhvc3RMaXN0ZW5lcignZm9jdXMnKVxuXHRvdmVycmlkZSBvbkZvY3VzKCkge1xuXHRcdHN1cGVyLm9uRm9jdXMoKTtcblx0fVxuXHRASG9zdExpc3RlbmVyKCdibHVyJylcblx0b3ZlcnJpZGUgb25CbHVyKCkge1xuXHRcdHN1cGVyLm9uQmx1cigpO1xuXHR9XG5cblx0bmdBZnRlclZpZXdJbml0KCkge1xuXHRcdHRoaXMuX2NoZWNrUGFuZWwoKTtcblx0XHR0aGlzLl9jaGVja1RhcmdldCgpO1xuXHR9XG5cdG5nT25EZXN0cm95KCkge1xuXHRcdHRoaXMuX2NsZWFuVXBTdWJzY3JpcHRpb25zKCk7XG5cdFx0aWYgKHRoaXMuX3BvcG92ZXJPcGVuKSB7XG5cdFx0XHR0aGlzLmNsb3NlUG9wb3ZlcigpO1xuXHRcdH1cblx0XHR0aGlzLmRlc3Ryb3lQb3BvdmVyKCk7XG5cdH1cblx0cHJvdGVjdGVkIF9lbWl0T3BlbigpOiB2b2lkIHtcblx0XHR0aGlzLm9uT3Blbi5lbWl0KCk7XG5cdH1cblx0cHJvdGVjdGVkIF9lbWl0Q2xvc2UoKTogdm9pZCB7XG5cdFx0dGhpcy5vbkNsb3NlLmVtaXQoKTtcblx0fVxufVxuIl19